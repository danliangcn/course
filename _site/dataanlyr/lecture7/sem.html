<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="">
<meta name="dcterms.date" content="2025-07-30">

<title>调节效应、中介效应和结构方程 – course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c1fac2584b48ed01fb6e278e36375074.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../css/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">course</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#调节效应和中介效应" id="toc-调节效应和中介效应" class="nav-link active" data-scroll-target="#调节效应和中介效应">调节效应和中介效应</a>
  <ul class="collapse">
  <li><a href="#调节效应" id="toc-调节效应" class="nav-link" data-scroll-target="#调节效应">调节效应</a></li>
  <li><a href="#中介效应" id="toc-中介效应" class="nav-link" data-scroll-target="#中介效应">中介效应</a></li>
  <li><a href="#条件过程模型" id="toc-条件过程模型" class="nav-link" data-scroll-target="#条件过程模型">条件过程模型</a></li>
  <li><a href="#条件过程模型的分析" id="toc-条件过程模型的分析" class="nav-link" data-scroll-target="#条件过程模型的分析">条件过程模型的分析</a></li>
  </ul></li>
  <li><a href="#结构方程的特点" id="toc-结构方程的特点" class="nav-link" data-scroll-target="#结构方程的特点">结构方程的特点</a></li>
  <li><a href="#结构方程模型分析的过程" id="toc-结构方程模型分析的过程" class="nav-link" data-scroll-target="#结构方程模型分析的过程">结构方程模型分析的过程</a></li>
  <li><a href="#结构方程的组成" id="toc-结构方程的组成" class="nav-link" data-scroll-target="#结构方程的组成">结构方程的组成</a>
  <ul class="collapse">
  <li><a href="#结构方程的变量" id="toc-结构方程的变量" class="nav-link" data-scroll-target="#结构方程的变量">结构方程的变量：</a></li>
  <li><a href="#结构方程的参数" id="toc-结构方程的参数" class="nav-link" data-scroll-target="#结构方程的参数">结构方程的参数：</a></li>
  <li><a href="#结构方程模型设定" id="toc-结构方程模型设定" class="nav-link" data-scroll-target="#结构方程模型设定">结构方程模型设定</a></li>
  </ul></li>
  <li><a href="#结构方程模型识别" id="toc-结构方程模型识别" class="nav-link" data-scroll-target="#结构方程模型识别">结构方程模型识别</a></li>
  <li><a href="#结构方程模型拟合评估" id="toc-结构方程模型拟合评估" class="nav-link" data-scroll-target="#结构方程模型拟合评估">结构方程模型拟合评估</a></li>
  <li><a href="#验证性因子分析" id="toc-验证性因子分析" class="nav-link" data-scroll-target="#验证性因子分析">验证性因子分析</a>
  <ul class="collapse">
  <li><a href="#验证性因子分析的原理" id="toc-验证性因子分析的原理" class="nav-link" data-scroll-target="#验证性因子分析的原理">验证性因子分析的原理</a></li>
  <li><a href="#internaltest" id="toc-internaltest" class="nav-link" data-scroll-target="#internaltest">CFA的内部拟合检验</a></li>
  <li><a href="#验证性因素分析的步骤" id="toc-验证性因素分析的步骤" class="nav-link" data-scroll-target="#验证性因素分析的步骤">验证性因素分析的步骤</a></li>
  <li><a href="#组织创新气氛测量模型" id="toc-组织创新气氛测量模型" class="nav-link" data-scroll-target="#组织创新气氛测量模型">组织创新气氛测量模型</a></li>
  <li><a href="#cfareport" id="toc-cfareport" class="nav-link" data-scroll-target="#cfareport">模型分析与报告</a></li>
  <li><a href="#测量模型的调整" id="toc-测量模型的调整" class="nav-link" data-scroll-target="#测量模型的调整">测量模型的调整</a></li>
  <li><a href="#模型的路径图" id="toc-模型的路径图" class="nav-link" data-scroll-target="#模型的路径图">模型的路径图</a></li>
  </ul></li>
  <li><a href="#路径分析" id="toc-路径分析" class="nav-link" data-scroll-target="#路径分析">路径分析</a>
  <ul class="collapse">
  <li><a href="#模型设定与识别" id="toc-模型设定与识别" class="nav-link" data-scroll-target="#模型设定与识别">模型设定与识别</a></li>
  <li><a href="#参数估计" id="toc-参数估计" class="nav-link" data-scroll-target="#参数估计">参数估计</a></li>
  <li><a href="#直接与间接效应" id="toc-直接与间接效应" class="nav-link" data-scroll-target="#直接与间接效应">直接与间接效应</a></li>
  <li><a href="#模型调整" id="toc-模型调整" class="nav-link" data-scroll-target="#模型调整">模型调整</a></li>
  </ul></li>
  <li><a href="#统合模型分析" id="toc-统合模型分析" class="nav-link" data-scroll-target="#统合模型分析">统合模型分析</a>
  <ul class="collapse">
  <li><a href="#统合模型的基础" id="toc-统合模型的基础" class="nav-link" data-scroll-target="#统合模型的基础">统合模型的基础</a></li>
  <li><a href="#统合模型分析的操作" id="toc-统合模型分析的操作" class="nav-link" data-scroll-target="#统合模型分析的操作">统合模型分析的操作</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">调节效应、中介效应和结构方程</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 30, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="调节效应和中介效应" class="level2">
<h2 class="anchored" data-anchor-id="调节效应和中介效应">调节效应和中介效应</h2>
<section id="调节效应" class="level3">
<h3 class="anchored" data-anchor-id="调节效应">调节效应</h3>
<section id="调节效应的基础" class="level4">
<h4 class="anchored" data-anchor-id="调节效应的基础">调节效应的基础</h4>
<p><strong>调节效应</strong>（Moderation Effect）是统计学和社会科学中的一个概念，指的是某个第三变量（称为<strong>调节变量</strong>或<strong>调节因子</strong>）能够改变两个其他变量之间的关系的强度或方向所产生的作用。通过调节效应的分析，可以更好地理解复杂的变量关系，为研究者提供更加精细化的理论指导和建议。</p>
<p>当一个调节变量存在时，它会通过<strong>影响自变量与因变量之间的关系</strong>来发挥作用。例如：</p>
<ul>
<li>如果 ( X ) 是自变量，( Y ) 是因变量，( Z ) 是调节变量，那么调节效应的核心是： [ Y = _0 + _1 X + _2 Z + _3 (X Z) + ] 其中，( _3 ) 是交互项系数，表示 ( Z ) 调节 ( X ) 和 ( Y ) 关系的强弱或方向。</li>
</ul>
</section>
<section id="调节效应的示例" class="level4">
<h4 class="anchored" data-anchor-id="调节效应的示例">调节效应的示例</h4>
<ol type="1">
<li>政府透明度与公众信任</li>
</ol>
<ul>
<li><strong>自变量（X）</strong>：政府透明度（Transparency）。</li>
<li><strong>因变量（Y）</strong>：公众对政府的信任（Public Trust）。</li>
<li><strong>调节变量（Z）</strong>：公民政治参与水平（Political Participation）。
<ul>
<li><strong>解释</strong>：高水平的政治参与可能会增强透明度对公众信任的正面影响，因为公民更关注并感受到透明度带来的好处。</li>
<li><strong>效果</strong>：
<ul>
<li><strong>高参与</strong>：透明度增加显著提高公众信任。</li>
<li><strong>低参与</strong>：透明度的影响不明显。</li>
</ul></li>
</ul></li>
</ul>
<ol start="2" type="1">
<li>财政分权与地方经济增长</li>
</ol>
<ul>
<li><strong>自变量（X）</strong>：财政分权程度（Fiscal Decentralization）。</li>
<li><strong>因变量（Y）</strong>：地方经济增长（Local Economic Growth）。</li>
<li><strong>调节变量（Z）</strong>：地方政府问责制（Government Accountability）。
<ul>
<li><strong>解释</strong>：高问责制的地方，财政分权带来的灵活性能更有效地促进经济增长；而低问责制可能导致腐败和低效。</li>
<li><strong>效果</strong>：
<ul>
<li><strong>高问责制</strong>：财政分权显著促进经济增长。</li>
<li><strong>低问责制</strong>：财政分权可能削弱经济增长。</li>
</ul></li>
</ul></li>
</ul>
<ol start="3" type="1">
<li>环境政策严格性与污染治理成效</li>
</ol>
<ul>
<li><strong>自变量（X）</strong>：环境政策严格性（Environmental Policy Stringency）。</li>
<li><strong>因变量（Y）</strong>：污染治理效果（Pollution Mitigation Effectiveness）。</li>
<li><strong>调节变量（Z）</strong>：企业技术创新能力（Technological Innovation in Firms）。
<ul>
<li><strong>解释</strong>：具有高技术创新能力的企业能够更好地适应和满足严格的环境政策要求。</li>
<li><strong>效果</strong>：
<ul>
<li><strong>高创新能力</strong>：政策严格性对治理成效有更大影响。</li>
<li><strong>低创新能力</strong>：政策严格性可能导致高成本而无法显著改善污染。</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="可视化调节效应" class="level4">
<h4 class="anchored" data-anchor-id="可视化调节效应">可视化调节效应</h4>
<p>调节效应通常用<strong>交互图</strong>（Interaction Plot）展示。</p>
<ul>
<li>将( X ) 和 ( Y ) 的关系在不同 ( Z ) 水平下的表现。<br>
</li>
<li>不同 ( Z ) 水平会呈现不同的斜率或曲线。</li>
</ul>
</section>
<section id="调节效应分析示例" class="level4">
<h4 class="anchored" data-anchor-id="调节效应分析示例">调节效应分析示例</h4>
<p>一项关于气候变化与灾害<a href="./chapman2015.pdf">Chapman and Lickel 2015</a>的研究中，研究者向211名实验参与者讲述非洲发生干旱造成人道主义危机，告诉其中一半的参与者气候变化是造成干旱的原因，另一半参与者未被告知任何关于干旱的原因。接着通过一系列问题让实验参与者评价拒绝援助的正当性，以及了解他们对气候变化的怀疑程度。最后了解参与者捐款的意愿。 实验的目的是了解框架（frame），即是否告知干旱是由于气候变化产生的，对捐助意愿(donate)的影响<a href="./disaster.csv">数据</a>。</p>
<p>假定对气候变化怀疑（skeptic）程度较高的人框架对捐助意愿的效应也比较小，会存在调节效应。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>disaster <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"disaster.csv"</span>, <span class="at">header =</span> T)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 调节效应</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>moderafit <span class="ot">&lt;-</span> <span class="fu">lm</span>(donate <span class="sc">~</span> frame <span class="sc">+</span> skeptic <span class="sc">+</span> frame<span class="sc">:</span>skeptic, <span class="at">data =</span> disaster)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(moderafit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = donate ~ frame + skeptic + frame:skeptic, data = disaster)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.8341 -0.7077  0.1659  0.9101  2.6682 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    5.02947    0.22632  22.223   &lt;2e-16 ***
frame          0.67930    0.33091   2.053   0.0413 *  
skeptic       -0.13953    0.05790  -2.410   0.0168 *  
frame:skeptic -0.17071    0.08393  -2.034   0.0432 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.234 on 207 degrees of freedom
Multiple R-squared:  0.1343,    Adjusted R-squared:  0.1218 
F-statistic: 10.71 on 3 and 207 DF,  p-value: 1.424e-06</code></pre>
</div>
</div>
</section>
</section>
<section id="中介效应" class="level3">
<h3 class="anchored" data-anchor-id="中介效应">中介效应</h3>
<p><strong>中介效应</strong>（Mediation Effect）是统计学和社会科学中的一个概念，指一个<strong>中介变量</strong>（Mediating Variable）在自变量（Independent Variable, (X)）和因变量（Dependent Variable, (Y)）之间起中介作用，即部分或全部传递自变量对因变量的影响。中介效应主要用于探讨变量之间的作用机制，揭示<strong>因果路径</strong>。中介效应的分析能够揭示隐藏的机制和作用路径，为理论研究提供深入的解释，并为实践应用提供精细化的决策依据。</p>
<section id="中介效应的基础" class="level4">
<h4 class="anchored" data-anchor-id="中介效应的基础">中介效应的基础</h4>
<p>如果 (X) 通过一个中介变量 (M) 影响 (Y)，这表明 (M) 是 (X) 和 (Y) 之间的中介变量。公式化表达为： [ X M Y ] 其中：</p>
<ul>
<li>(X)：自变量，独立变量。</li>
<li>(Y)：因变量，依赖变量。</li>
<li>(M)：中介变量。</li>
</ul>
<p>中介效应说明 (X) 不仅直接影响 (Y)（直接效应），还通过 (M) 间接影响 (Y)（间接效应）。</p>
</section>
<section id="中介效应的数学模型" class="level4">
<h4 class="anchored" data-anchor-id="中介效应的数学模型">中介效应的数学模型</h4>
<p>经典的中介效应模型可以分为三步：</p>
<ol type="1">
<li><strong>总效应模型</strong>：(Y = cX + _1)，其中 (c) 是 (X) 对 (Y) 的总效应。</li>
<li><strong>中介变量模型</strong>：(M = aX + _2)，其中 (a) 是 (X) 对 (M) 的效应。</li>
<li><strong>结果变量模型</strong>：(Y = c’X + bM + _3)，
<ul>
<li>(c’)：控制 (M) 后，(X) 对 (Y) 的直接效应。</li>
<li>(b)：(M) 对 (Y) 的效应。</li>
</ul></li>
</ol>
<p>间接效应由 (a b) 表示，总效应可以分解为： [ c = c’ + (a b) ]</p>
</section>
<section id="中介效应模型的效应类型" class="level4">
<h4 class="anchored" data-anchor-id="中介效应模型的效应类型">中介效应模型的效应类型</h4>
<ul>
<li><strong>总效应</strong>：自变量对因变量的总影响，包括直接效应和间接效应。</li>
<li><strong>直接效应</strong>：自变量对因变量的直接影响，不通过中介变量传递。</li>
<li><strong>间接效应</strong>：自变量通过中介变量对因变量的影响。</li>
</ul>
</section>
<section id="中介效应的类型" class="level4">
<h4 class="anchored" data-anchor-id="中介效应的类型">中介效应的类型</h4>
<ol type="1">
<li><strong>完全中介效应</strong>（Full Mediation）
<ul>
<li>(X) 对 (Y) 的影响完全通过 (M) 传递。</li>
<li>控制 (M) 后，(X) 对 (Y) 的直接效应 (c’) 不显著。</li>
</ul></li>
<li><strong>部分中介效应</strong>（Partial Mediation）
<ul>
<li>(X) 对 (Y) 的影响部分通过 (M) 传递。</li>
<li>控制 (M) 后，(X) 对 (Y) 的直接效应 (c’) 仍然显著。</li>
</ul></li>
</ol>
</section>
<section id="中介效应的示例" class="level4">
<h4 class="anchored" data-anchor-id="中介效应的示例">中介效应的示例</h4>
<ol type="1">
<li>教育政策研究</li>
</ol>
<ul>
<li><strong>自变量</strong>：教育投资（Education Investment）。</li>
<li><strong>中介变量</strong>：师资水平（Teacher Quality）。</li>
<li><strong>因变量</strong>：学生成绩（Student Performance）。
<ul>
<li><strong>解释</strong>：教育投资可以通过提升师资水平来间接影响学生成绩。</li>
</ul></li>
</ul>
<ol start="2" type="1">
<li>公共卫生领域</li>
</ol>
<ul>
<li><strong>自变量</strong>：健康教育活动（Health Education）。</li>
<li><strong>中介变量</strong>：健康知识水平（Health Knowledge）。</li>
<li><strong>因变量</strong>：健康行为（Health Behavior）。
<ul>
<li><strong>解释</strong>：健康教育活动通过提高健康知识水平，进而改变人们的健康行为。</li>
</ul></li>
</ul>
<ol start="3" type="1">
<li>公共服务数字化与市民满意度</li>
</ol>
<ul>
<li><strong>自变量（X）</strong>：公共服务数字化水平（Digitalization of Public Services）。</li>
<li><strong>中介变量（M）</strong>：服务便利性（Convenience of Service）。</li>
<li><strong>因变量（Y）</strong>：市民满意度（Citizen Satisfaction）。
<ul>
<li><strong>解释</strong>：数字化的服务提高了服务的便利性，间接提升市民对公共服务的满意度。</li>
</ul></li>
</ul>
</section>
<section id="中介效应的检验方法" class="level4">
<h4 class="anchored" data-anchor-id="中介效应的检验方法">中介效应的检验方法</h4>
<ul>
<li><strong>逐步回归分析</strong>：按照三步模型依次验证每个路径的显著性。</li>
<li><strong>Bootstrap方法</strong>：通过重复抽样计算间接效应及其置信区间，常用于提高检验效力。</li>
<li><strong>Sobel检验</strong>：检验间接效应是否显著，计算公式为： [ z = ] 其中 () 表示估计系数的标准误。</li>
</ul>
</section>
<section id="中介效应与调节效应的区别" class="level4">
<h4 class="anchored" data-anchor-id="中介效应与调节效应的区别">中介效应与调节效应的区别</h4>
<ul>
<li><strong>中介效应</strong>：关注变量之间的<strong>因果路径</strong>，解释“<strong>为什么</strong>”自变量会影响因变量。</li>
<li><strong>调节效应</strong>：关注变量之间的<strong>关系强弱</strong>，解释“<strong>在什么情况下</strong>”自变量会影响因变量。</li>
</ul>
</section>
<section id="中介效应分析的示例" class="level4">
<h4 class="anchored" data-anchor-id="中介效应分析的示例">中介效应分析的示例</h4>
<p>上面气候变化与灾害的研究中，框架可能是通过影响正当性，然后正当性再影响捐助意愿的，即中介效应。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 中介效应</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>mediamodel <span class="ot">&lt;-</span> <span class="st">' # 直接效应</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">donate ~ c*frame</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st"># 中介效应</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">justify ~ a*frame</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">donate ~ b*justify</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st"># 间接效应 (a*b)</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="st">ab := a*b</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st"># 总效应</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">total := c + (a*b)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>mediafit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mediamodel, <span class="at">data =</span> disaster)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mediafit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           211

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  donate ~                                            
    frame      (c)    0.212    0.135    1.576    0.115
  justify ~                                           
    frame      (a)    0.134    0.127    1.054    0.292
  donate ~                                            
    justify    (b)   -0.953    0.072  -13.159    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .donate            0.948    0.092   10.271    0.000
   .justify           0.856    0.083   10.271    0.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    ab               -0.128    0.122   -1.051    0.293
    total             0.084    0.181    0.463    0.643</code></pre>
</div>
</div>
<p>绘制图形</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"semPlot"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(mediafit,<span class="at">whatLabels =</span> <span class="st">'est'</span>,<span class="at">residuals =</span> F, <span class="at">nCharNodes=</span><span class="dv">0</span>, <span class="at">sizeMan =</span> <span class="dv">12</span>,<span class="at">edge.label.cex =</span> <span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/mediationplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="条件过程模型" class="level3">
<h3 class="anchored" data-anchor-id="条件过程模型">条件过程模型</h3>
<p><strong>条件过程模型</strong>（Conditional Process Model）是一个综合框架，用于同时分析<strong>中介效应</strong>（Mediation Effect）和<strong>调节效应</strong>（Moderation Effect）。它探讨自变量通过中介变量影响因变量的机制，同时考虑调节变量如何影响这一机制的强度或方向。条件过程模型是一种强大的分析工具，能够揭示复杂的变量关系，为研究者提供深入的理论解释和实践指导。</p>
<section id="条件过程模型的基础" class="level4">
<h4 class="anchored" data-anchor-id="条件过程模型的基础">条件过程模型的基础</h4>
<p>条件过程模型结合了中介效应和调节效应，回答以下关键问题：</p>
<ul>
<li><strong>机制问题</strong>：自变量如何通过中介变量间接影响因变量？（中介效应）</li>
<li><strong>情境问题</strong>：这种中介效应在什么情况下更强或更弱？（调节效应）</li>
</ul>
<p>公式化表示为： [ Y = b_1 M + b_2 X + b_3 W + b_4 (M W) + ] 其中：</p>
<ul>
<li>(X)：自变量。</li>
<li>(M)：中介变量。</li>
<li>(Y)：因变量。</li>
<li>(W)：调节变量。</li>
<li>(b_4)：调节变量 (W) 对中介效应的调节作用。</li>
</ul>
</section>
<section id="条件过程模型的关键特征" class="level4">
<h4 class="anchored" data-anchor-id="条件过程模型的关键特征">条件过程模型的关键特征</h4>
<ul>
<li><strong>中介效应的调节</strong>：调节变量 (W) 改变了自变量 (X) 通过中介变量 (M) 对因变量 (Y) 的间接影响。</li>
<li><strong>模型交互</strong>：条件过程模型包含交互项（例如 (M W)），用来描述调节效应如何影响中介效应。</li>
<li><strong>多路径分析</strong>：条件过程模型可以同时研究直接效应、间接效应和调节效应。</li>
</ul>
</section>
<section id="条件过程模型的类型和示例" class="level4">
<h4 class="anchored" data-anchor-id="条件过程模型的类型和示例">条件过程模型的类型和示例</h4>
<ol type="1">
<li>调节的中介效应（Moderated Mediation Effect）</li>
</ol>
<ul>
<li><strong>定义</strong>：调节变量影响中介效应中某一路径的强度或方向。</li>
<li>解释：调节变量 ((W)) 改变了自变量 ((X)) 通过中介变量 ((M)) 对因变量 ((Y)) 的间接效应。</li>
<li>(X)：自变量</li>
<li>(M)：中介变量</li>
<li>(W)：调节变量，对 (X M) 或 (M Y) 的路径进行调节</li>
<li>(Y)：因变量</li>
</ul>
<p><strong>示例</strong>：环保政策严格性 ((X)) 通过企业创新 ((M)) 改善环境质量 ((Y))，但监管强度 ((W)) 调节这一过程。</p>
<ol start="2" type="1">
<li>中介的调节效应（Mediated Moderation Effect）</li>
</ol>
<ul>
<li><strong>定义</strong>：中介变量的某一路径影响受调节变量的影响。</li>
<li><strong>解释</strong>：中介变量 ((M)) 解释了调节变量 ((W)) 如何影响自变量 ((X)) 对因变量 ((Y)) 的关系。</li>
<li>(X W)：自变量和调节变量的交互作用</li>
<li>(M)：中介变量，解释交互作用如何影响 (Y)</li>
<li>(Y)：因变量</li>
</ul>
<p><strong>示例</strong>：政策执行力度 ((X)) 和地方经济发展水平 ((W)) 的交互作用通过基层治理能力 ((M)) 间接影响社会稳定 ((Y))。</p>
<ol start="3" type="1">
<li>结合复杂模型（Combined Model）</li>
</ol>
<p><strong>解释</strong>：同时存在调节的中介效应和中介的调节效应，展示了变量之间更复杂的关系。 - (X → M → Y)：中介效应 - (W)：调节变量同时作用于 (X → M) 和 (M → Y) 的路径。</p>
<p><strong>示例</strong>：公共政策透明度 ((X)) 通过公众信任 ((M)) 增强公众满意度 ((Y))，但这种过程因社会参与度 ((W)) 的不同而改变。</p>
</section>
<section id="条件过程模型的分析方法" class="level4">
<h4 class="anchored" data-anchor-id="条件过程模型的分析方法">条件过程模型的分析方法</h4>
<ol type="1">
<li>基于回归分析的交互项建模<br>
</li>
</ol>
<ul>
<li>在回归模型中添加中介变量、调节变量以及交互项（如 (M W)）。<br>
</li>
<li>分析每个路径系数的显著性以验证条件过程关系。</li>
</ul>
<ol start="2" type="1">
<li>Bootstrap法<br>
</li>
</ol>
<ul>
<li>通过Bootstrap重复抽样方法计算间接效应的置信区间。<br>
</li>
<li>验证不同调节水平下的中介效应是否显著。</li>
</ul>
<ol start="3" type="1">
<li>PROCESS工具<br>
</li>
</ol>
<ul>
<li>PROCESS工具是Andrew F. Hayes开发的一个专用宏，用于SPSS和R语言，可以直接分析复杂的条件过程模型。</li>
</ul>
<ol start="4" type="1">
<li>结构方程的路径分析<br>
</li>
</ol>
<ul>
<li>结合各类的结构方程分析软件进行路径分析。</li>
</ul>
</section>
<section id="条件过程模型的优点" class="level4">
<h4 class="anchored" data-anchor-id="条件过程模型的优点">条件过程模型的优点</h4>
<ul>
<li><strong>综合性强</strong>：能够同时分析机制问题（中介效应）和情境问题（调节效应）。</li>
<li><strong>解释力强</strong>：揭示复杂的因果路径和不同情境下的效果差异。</li>
<li><strong>广泛适用</strong>：适用于社会科学、心理学、公共管理等多个领域。</li>
</ul>
</section>
</section>
<section id="条件过程模型的分析" class="level3">
<h3 class="anchored" data-anchor-id="条件过程模型的分析">条件过程模型的分析</h3>
<p>综合调节与中介效应，框架对捐助意愿的直接和间接效应是受到怀疑程度的调节的，即被调节的中介效应。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 具有调节中介效应的条件过程模型</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cpmodel <span class="ot">&lt;-</span> <span class="st">' # 直接效应</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">donate ~ c1*frame + c2*skeptic + c3*skeptic:frame </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st"># 中介效应</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">justify ~ a1*frame + a2*skeptic + a3*skeptic:frame</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">donate ~ b*justify</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st"># 间接效应取决于skeptic的值，需要用平均值（或其他代表值）带入计算间接效应</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="st"># 间接效应 (a*b) skeptic取平均值3.38</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="st">a1b := (a1+a3*3.38)*b</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="st"># 总效应</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="st">total := c1 + (a1+a3*3.38)*b</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>cpfit <span class="ot">&lt;-</span> <span class="fu">sem</span>(cpmodel, <span class="at">data =</span> disaster)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cpfit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9

  Number of observations                           211

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  donate ~                                            
    frame     (c1)    0.160    0.264    0.606    0.544
    skeptic   (c2)   -0.043    0.046   -0.918    0.359
    skptc:frm (c3)    0.015    0.068    0.219    0.827
  justify ~                                           
    frame     (a1)   -0.562    0.216   -2.606    0.009
    skeptic   (a2)    0.105    0.038    2.782    0.005
    skptc:frm (a3)    0.201    0.055    3.675    0.000
  donate ~                                            
    justify    (b)   -0.923    0.083  -11.113    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .donate            0.943    0.092   10.271    0.000
   .justify           0.648    0.063   10.271    0.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    a1b              -0.108    0.103   -1.054    0.292
    total             0.052    0.285    0.182    0.856</code></pre>
</div>
</div>
<p>图形</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(cpfit,<span class="at">whatLabels =</span> <span class="st">'est'</span>, <span class="at">layout =</span> <span class="st">"spring"</span>,,<span class="at">residuals =</span> F, <span class="at">nCharNodes=</span><span class="dv">0</span>, <span class="at">sizeMan =</span> <span class="dv">8</span>,<span class="at">edge.label.cex =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/condprocplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="结构方程的特点" class="level2">
<h2 class="anchored" data-anchor-id="结构方程的特点">结构方程的特点</h2>
<ul>
<li>结构方程分析需要建立在理论基础上，从变量的测量、变量关系的假定和模型的设定都需要有清晰的理论支持或逻辑推理作为依据。</li>
<li>结构方程模型同时处理潜变量的测量和变量间关系的分析，变量测量中的误差也被包含在变量关系的分析过程中。</li>
<li>结构方程是基于变量间的协方差进行分析，协方差能够反映变量间的关联，也能反映理论模型生成的协方差与实际观测所得的协方差之间的差异。</li>
<li>结构方程需要大样本，样本量大于200。</li>
<li>结构方程的评估基于多重指标对整体模型进行比较，不依赖于单一的统计显著性。</li>
</ul>
</section>
<section id="结构方程模型分析的过程" class="level2">
<h2 class="anchored" data-anchor-id="结构方程模型分析的过程">结构方程模型分析的过程</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="semflow.png" class="img-fluid figure-img" width="284"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="结构方程的组成" class="level2">
<h2 class="anchored" data-anchor-id="结构方程的组成">结构方程的组成</h2>
<section id="结构方程的变量" class="level3">
<h3 class="anchored" data-anchor-id="结构方程的变量">结构方程的变量：</h3>
<ul>
<li>结构方程主要变量为尺度变量，类别变量只作为分组讨论的调节变量。</li>
<li>潜变量(F)必须有两个以上（一般为3个以上，2个的情况需要模型存在多个潜变量，且之间存在关联性）的测量变量(V1, V2)，测量变量间的协方差反映潜在变量的共同影响，测量变量无法被潜变量解释的部分为测量误差(E1, E2)。</li>
<li>内生潜变量所影响（对应）的为内生测量变量，外生潜变量所影响（对应）的为外生测量变量，内生潜变量的残差称为干扰项。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="variables.png" class="img-fluid figure-img" width="141"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="internal.png" class="img-fluid figure-img" width="176"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="param.png" class="img-fluid figure-img" width="208"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="结构方程的参数" class="level3">
<h3 class="anchored" data-anchor-id="结构方程的参数">结构方程的参数：</h3>
<ul>
<li>测量模型参数包括潜变量与测量变量的关联强度<span class="math inline">\(\lambda\)</span>，也成为因子载荷，外生测量变量的测量误差<span class="math inline">\(\delta\)</span>，内生测量变量的测量误差<span class="math inline">\(\varepsilon\)</span>，外生变量的协方差<span class="math inline">\(\phi\)</span>。</li>
<li>结构模型参数包括外生潜变量与内生潜变量之间的关系<span class="math inline">\(\gamma\)</span>，内生潜变量之间的关系<span class="math inline">\(\beta\)</span>，内生潜变量的残差或干扰项<span class="math inline">\(\zeta\)</span>。</li>
</ul>
</section>
<section id="结构方程模型设定" class="level3">
<h3 class="anchored" data-anchor-id="结构方程模型设定">结构方程模型设定</h3>
<ul>
<li>简效原则：将变量间的关系以最符合理论又最简单扼要的方式加以设定。如果一个简单模型能够解释较多实际数据的变化，那么以这个模型来说明数据的关系，比较不会得到错误的结论，结构方程可以防止弃真错误，难以防止纳伪错误。</li>
<li>结构方程会遇到等值模型问题，即不同设定的模型拟合优度相等，可以通过前导理论策略（通过理论排除对等的模型）或参数竞争比较策略（比较对等模型参数估计）来解决。</li>
</ul>
</section>
</section>
<section id="结构方程模型识别" class="level2">
<h2 class="anchored" data-anchor-id="结构方程模型识别">结构方程模型识别</h2>
<ul>
<li>结构方程的不同设定会产生模型识别问题，只有在过度识别条件下，才能对模型参数进行计算估计。通过比较待估参数数量<span class="math inline">\(t\)</span>和测量数据量<span class="math inline">\(DP\)</span>之间的大小，可以判断（必要不充分）模型能否参数估计。
<ul>
<li>当<span class="math inline">\(t &lt; DP\)</span>，为过度识别，如同有三个方程，求两个未知数的解。</li>
<li>当<span class="math inline">\(t = DP\)</span>，为充分识别，如同有两个个方程，求两个未知数的解。</li>
<li>当<span class="math inline">\(t &gt; DP\)</span>，为识别不足，如同只有一个方程，求两个未知数的解。</li>
<li>其中，待估参数数量<span class="math inline">\(t\)</span>根据具体的模型设定决定，测量数据量<span class="math inline">\(DP\)</span>由外生测量变量的个数<span class="math inline">\(p\)</span>和内生测量变量的个数<span class="math inline">\(q\)</span>计算。 <span class="math display">\[DP=\frac{(p+q)(p+q+1)}{2}\]</span></li>
</ul></li>
<li>当结构方程模型设定没有结构关系的假设，模型可以顺利识别（Null Beta Rule）；当结构方程模型设定只估计结构参数，干扰项只估计方差不估计相关，模型自动识别（递归法则）。尽量保持简单的模型结构。</li>
</ul>
</section>
<section id="结构方程模型拟合评估" class="level2">
<h2 class="anchored" data-anchor-id="结构方程模型拟合评估">结构方程模型拟合评估</h2>
<ul>
<li>结构方程模型分析策略与一般统计推断有明显差异，是以支持原假设作为模型拟合度存在的证据。</li>
<li>结构方程的原假设是偏好的模型（根据理论对结构系数做出了某些假定，某些系数不为零）与实际观察的数据是相符的，其检验则是通过与饱和模型（对各观察变量之间关系都做了相关假定，所有系数均不为零）相比较，如果模型之间卡方检验值比较大，则说明两个模型存在显著差异，拒绝原假设（拒绝偏好的模型），接受饱和模型。</li>
<li>模型的卡方统计量、自由度和p值，卡方值越小越好，p值大于0.05。但是样本量越大，p值会减少倾向显著，作为拟合优度指标并不准确，需要考虑其他拟合指数。如果模型正确，卡方统计量会等于其自由度，但增加估计参数的数量会减小卡方值。</li>
<li>近似均方根残差Root Mean Square Error of Approximation (RMSEA; Steiger, 1990) 和90%的置信区间，越小越好，小于0.08比较理想。</li>
<li>比较拟合指数Comparative Fit Index (CFI; Bentler, 1990)，越大越好，应大于0.9。</li>
<li>标准化均方根残差Standardized Root Mean Square Residual (SRMR)，越小越好，大于0.1说明拟合不好。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="fitindex.png" class="img-fluid figure-img" width="332"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="验证性因子分析" class="level2">
<h2 class="anchored" data-anchor-id="验证性因子分析">验证性因子分析</h2>
<section id="验证性因子分析的原理" class="level3">
<h3 class="anchored" data-anchor-id="验证性因子分析的原理">验证性因子分析的原理</h3>
<ul>
<li>不同于探索性因子分析（EFA），验证性因子分析（CFA）必须有特定的理论或概念架构作为基础。CFA可以作为结构方程模型的前置步骤，也可以独立进行，只检验测量模型。</li>
<li>CFA要求构念要有明确的操作化定义界定内容与范畴；测量构念的指标要能被明确指出，并且同一构念指标要具有相当的一致性，不同构念指标要具有区分度；还要经过统计验证观察数据能否支持或推翻构念是否存在的假设。</li>
<li>CFA模型中，从潜变量到测量变量的箭头，代表研究者所假设的潜变量到测量变量的因果关系，统计估计量称为因子载荷，类似于回归系数，测量变量的变异可以拆解为共同变异（common variance）和独特变异（unique variance）。</li>
<li>与回归模型将测量误差作为随机误差处理不同，CFA将测量变量中分离独特变异，这种变异包括了随机误差和系统误差（例如方法效益带来的误差，会导致题项相关系数偏大）。CFA可以通过共变关系分析和多维测量假设有效估计独特变异中的系统性误差。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa1.png" class="img-fluid figure-img" width="174"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa2.png" class="img-fluid figure-img" width="186"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa3.png" class="img-fluid figure-img" width="168"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa4.png" class="img-fluid figure-img" width="175"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="internaltest" class="level3">
<h3 class="anchored" data-anchor-id="internaltest">CFA的内部拟合检验</h3>
<ul>
<li>CFA除了要求整体拟合效果外，还要求针对个别因子的质量进行检验，了解个别参数是否理想（项目信效度），各潜变量的组合情形是否稳定可靠（构念的信效度）。遇到不理想的参数，可以剔除不良题项或添加参数提高测量模型的内在拟合。</li>
<li>项目质量检验：题项测量误差越小则信度越高，而因子载荷越高则测量误差越小，所以可以用因子载荷来判断题项质量。一般当因子载荷<span class="math inline">\(\lambda\)</span>大于0.71时，<span class="math inline">\(\lambda^2\)</span>为50%，意味着潜变量能够解释测量变量50%的变异（即回归的R方），说明项目具有理想质量。但是对于社会科学而言，编制的量表因子载荷都不会太高，因子载荷<span class="math inline">\(\lambda\)</span>大于0.55（<span class="math inline">\(\lambda^2\)</span>为30%）即是理想的结果。</li>
<li>组合信度（<span class="math inline">\(\rho_c\)</span>）：对于一组题项而言，潜变量的变异代表真实分数的变异，因此题项的组合信度可以用测量变量变异被潜变量解释的百分比来表示（类似于内部一致性系数，<span class="math inline">\(Cronbach's \quad \alpha\)</span>）。一般量表信度需达到0.7，社会科学领域不易达到此水平，0.5以上可认为获得基本稳定性。</li>
</ul>
<p><span class="math display">\[\rho_c=\frac{(\Sigma\lambda_i)^2}{((\Sigma\lambda_i)^2 + \Sigma\Theta_{ii}+2\Sigma\Theta_{ij})}\]</span></p>
<ul>
<li>平均变异萃取量（<span class="math inline">\(\rho_\nu\)</span>）：测量题项的因子载荷越高，表示题项能够反映潜变量的能力越高，潜变量因子能够解释各个测量变量变异的程度越大，因此可以用平均变异萃取量（即EFA中的特征值）反映潜变量被测量变量有效估计的聚敛程度。<span class="math inline">\(\rho_\nu\)</span>大于0.5，表示潜变量聚敛能力理想。</li>
</ul>
<p><span class="math display">\[\rho_{\nu}=\frac{\Sigma\lambda^2_i}{(\Sigma\lambda^2_i + \Sigma\Theta_{ii})}=\frac{\Sigma\lambda^2_i}{n}\]</span></p>
<ul>
<li>因素区辩力：不同潜变量之间必须能够有效分离。
<ul>
<li>相关系数区间估计：如果两个潜变量的相关系数的95%置信区间包含1，表示构念缺乏区辩力。<br>
</li>
<li>竞争模式比较法：将设定CFA模型与完全相关模型（将潜变量的相关设定为1）相比较，如果两个模型没有区别，表示构念缺乏区辩力。<br>
</li>
<li>平均变异萃取量比较法：比较两个潜变量的平均变异萃取量的平均值是否大于其相关系数的平方。</li>
</ul></li>
</ul>
</section>
<section id="验证性因素分析的步骤" class="level3">
<h3 class="anchored" data-anchor-id="验证性因素分析的步骤">验证性因素分析的步骤</h3>
<ol type="1">
<li>建立测量模型的假设</li>
<li>进行模型识别，输入模型指令</li>
<li>执行CFA分析</li>
<li>结果分析</li>
<li>模型修正</li>
<li>完成分析，给出报告</li>
</ol>
</section>
<section id="组织创新气氛测量模型" class="level3">
<h3 class="anchored" data-anchor-id="组织创新气氛测量模型">组织创新气氛测量模型</h3>
<p>案例来自《组织创新气氛量表》（邱皓政，1999），样本是384位企业员工，量表为Likert式6点度量的自陈量表，基于理论和文献先界定影响组织气氛知觉的因素包括组织价值、工作方式、团队合作、领导风格、学习成长、环境气氛等6个因素，每个因素采用3个题项测量，共有18个题项，题项描述性统计如下。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"ch05.sav"</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A1"</span>,<span class="st">"A2"</span>,<span class="st">"A3"</span>,<span class="st">"B1"</span>,<span class="st">"B2"</span>,<span class="st">"B3"</span>,<span class="st">"C1"</span>,<span class="st">"C2"</span>,<span class="st">"C3"</span>,<span class="st">"D1"</span>,<span class="st">"D2"</span>,<span class="st">"D3"</span>,<span class="st">"E1"</span>,<span class="st">"E2"</span>,<span class="st">"E3"</span>,<span class="st">"F1"</span>,<span class="st">"F2"</span>,<span class="st">"F3"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">zap_labels</span>(dat)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dat) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 313  18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(dat, <span class="at">fun_numeric =</span> <span class="fu">list</span>(<span class="st">'取值'</span><span class="ot">=</span>NUnique, <span class="st">'缺失值'</span><span class="ot">=</span>PercentMissing, <span class="st">'均值'</span><span class="ot">=</span>Mean, <span class="st">'中位数'</span><span class="ot">=</span>Median,<span class="st">'标准差'</span><span class="ot">=</span>SD, <span class="st">'最小值'</span><span class="ot">=</span>Min, <span class="st">'最大值'</span><span class="ot">=</span>Max), <span class="at">output =</span> <span class="st">"data.frame"</span>, <span class="at">type =</span> <span class="st">"numeric"</span>, <span class="fu">fmt_sprintf</span>(<span class="st">"%.2f"</span>)) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">取值</th>
<th style="text-align: left;">缺失值</th>
<th style="text-align: left;">均值</th>
<th style="text-align: left;">中位数</th>
<th style="text-align: left;">标准差</th>
<th style="text-align: left;">最小值</th>
<th style="text-align: left;">最大值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.42</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">A2</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.31</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.02</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A3</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.07</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">B1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.02</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B2</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.25</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.16</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">B3</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.24</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.37</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">C2</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.34</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.03</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C3</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.31</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.05</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">D1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.83</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">D2</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.95</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.84</td>
<td style="text-align: left;">2.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">D3</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.83</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.91</td>
<td style="text-align: left;">2.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.63</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.97</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">E2</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.73</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">1.01</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">E3</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.70</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.98</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F1</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.23</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">1.17</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F2</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.63</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">1.09</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">F3</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.49</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.94</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="测量模型的设定" class="level4">
<h4 class="anchored" data-anchor-id="测量模型的设定">测量模型的设定</h4>
<ul>
<li>模型有18个测量变量和6个潜变量</li>
<li>模型中18个测量误差</li>
<li>为确定6个潜变量的度量，每个因素方差设定为1</li>
<li>每个测量变量只受单一潜变量影响，因此有18个因子载荷参数</li>
<li>因子共变允许自由估计，产生15个相关系数参数</li>
<li>测量误差之间视为独立，没有共变关系</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa5.png" class="img-fluid figure-img" width="246"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="测量模型的识别" class="level4">
<h4 class="anchored" data-anchor-id="测量模型的识别">测量模型的识别</h4>
<ul>
<li>测量数据<span class="math inline">\(DP=18\times(18+1)/2=171\)</span></li>
<li>模型待估参数包括18个因子载荷、18个测量误差、15个潜变量协方差（潜变量方差设定为1，不需要估计），因此待估参数<span class="math inline">\(t=18+18+15=51\)</span></li>
<li>因为待估参数小于测量数据，所以测量模型可以识别</li>
</ul>
</section>
</section>
<section id="cfareport" class="level3">
<h3 class="anchored" data-anchor-id="cfareport">模型分析与报告</h3>
<p><code>lavaan</code>包的模型设定默认不同潜变量之间具有相关性（即允许因子共变），如果需要不同的设定，可以在cfa函数中用<span class="math inline">\(orthogonal=T\)</span>将协方差约束为0；<code>cfa</code>函数默认是将第1个因子载荷设定为1，如需固定潜变量方差为1，可以通过<span class="math inline">\(std.lv=TRUE\)</span>来设定。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cfa_model  <span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">#定义测量模型  </span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">  FA =~ L11*A1 + L21*A2 + L31*A3</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">  FB =~ L12*B1 + L22*B2 + L32*B3</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FC =~ L13*C1 + L23*C2 + L33*C3</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">  FD =~ L14*D1 + L24*D2 + L34*D3</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">  FE =~ L15*E1 + L25*E2 + L35*E3</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FF =~ L16*F1 + L26*F2 + L36*F3'</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>cfa_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> cfa_model, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> dat,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">std.lv =</span> <span class="cn">TRUE</span>) <span class="co"># 根据模型设定，固定潜变量方差为1</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_fit, </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> T, <span class="co"># 输出拟合指标</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">standard =</span> T)  <span class="co"># 输出标准化解</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 31 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        51

  Number of observations                           313

Model Test User Model:
                                                      
  Test statistic                               241.755
  Degrees of freedom                               120
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                              2842.819
  Degrees of freedom                               153
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.955
  Tucker-Lewis Index (TLI)                       0.942

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -6751.785
  Loglikelihood unrestricted model (H1)      -6630.907
                                                      
  Akaike (AIC)                               13605.569
  Bayesian (BIC)                             13796.626
  Sample-size adjusted Bayesian (SABIC)      13634.870

Root Mean Square Error of Approximation:

  RMSEA                                          0.057
  90 Percent confidence interval - lower         0.047
  90 Percent confidence interval - upper         0.067
  P-value H_0: RMSEA &lt;= 0.050                    0.132
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.052

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  FA =~                                                                 
    A1       (L11)    0.815    0.051   15.967    0.000    0.815    0.830
    A2       (L21)    0.706    0.055   12.733    0.000    0.706    0.692
    A3       (L31)    0.614    0.054   11.430    0.000    0.614    0.634
  FB =~                                                                 
    B1       (L12)    0.789    0.062   12.759    0.000    0.789    0.682
    B2       (L22)    0.961    0.058   16.591    0.000    0.961    0.833
    B3       (L32)    0.856    0.056   15.406    0.000    0.856    0.788
  FC =~                                                                 
    C1       (L13)    0.699    0.053   13.178    0.000    0.699    0.717
    C2       (L23)    0.736    0.056   13.119    0.000    0.736    0.715
    C3       (L33)    0.696    0.058   11.950    0.000    0.696    0.663
  FD =~                                                                 
    D1       (L14)    0.810    0.045   18.177    0.000    0.810    0.867
    D2       (L24)    0.741    0.040   18.750    0.000    0.741    0.886
    D3       (L34)    0.655    0.047   14.086    0.000    0.655    0.720
  FE =~                                                                 
    E1       (L15)    0.806    0.046   17.392    0.000    0.806    0.830
    E2       (L25)    0.912    0.046   19.851    0.000    0.912    0.906
    E3       (L35)    0.791    0.047   16.810    0.000    0.791    0.811
  FF =~                                                                 
    F1       (L16)    0.641    0.066    9.663    0.000    0.641    0.550
    F2       (L26)    0.828    0.058   14.296    0.000    0.828    0.758
    F3       (L36)    0.786    0.049   16.142    0.000    0.786    0.837

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  FA ~~                                                                 
    FB                0.542    0.054    9.989    0.000    0.542    0.542
    FC                0.494    0.061    8.102    0.000    0.494    0.494
    FD                0.417    0.058    7.176    0.000    0.417    0.417
    FE                0.526    0.052   10.080    0.000    0.526    0.526
    FF                0.695    0.046   15.148    0.000    0.695    0.695
  FB ~~                                                                 
    FC                0.697    0.047   14.906    0.000    0.697    0.697
    FD                0.447    0.055    8.127    0.000    0.447    0.447
    FE                0.575    0.048   12.091    0.000    0.575    0.575
    FF                0.391    0.061    6.403    0.000    0.391    0.391
  FC ~~                                                                 
    FD                0.522    0.055    9.493    0.000    0.522    0.522
    FE                0.603    0.050   12.127    0.000    0.603    0.603
    FF                0.600    0.054   11.032    0.000    0.600    0.600
  FD ~~                                                                 
    FE                0.557    0.046   12.046    0.000    0.557    0.557
    FF                0.316    0.062    5.137    0.000    0.316    0.316
  FE ~~                                                                 
    FF                0.443    0.056    7.944    0.000    0.443    0.443

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .A1                0.300    0.046    6.509    0.000    0.300    0.311
   .A2                0.544    0.055    9.980    0.000    0.544    0.522
   .A3                0.561    0.052   10.700    0.000    0.561    0.598
   .B1                0.716    0.068   10.525    0.000    0.716    0.535
   .B2                0.408    0.057    7.211    0.000    0.408    0.306
   .B3                0.447    0.052    8.602    0.000    0.447    0.379
   .C1                0.461    0.050    9.305    0.000    0.461    0.485
   .C2                0.519    0.055    9.354    0.000    0.519    0.489
   .C3                0.618    0.061   10.173    0.000    0.618    0.560
   .D1                0.217    0.031    7.055    0.000    0.217    0.248
   .D2                0.151    0.024    6.204    0.000    0.151    0.215
   .D3                0.399    0.037   10.799    0.000    0.399    0.482
   .E1                0.292    0.032    9.243    0.000    0.292    0.311
   .E2                0.181    0.030    6.113    0.000    0.181    0.179
   .E3                0.325    0.033    9.733    0.000    0.325    0.342
   .F1                0.948    0.083   11.400    0.000    0.948    0.698
   .F2                0.507    0.058    8.700    0.000    0.507    0.425
   .F3                0.265    0.042    6.276    0.000    0.265    0.300
    FA                1.000                               1.000    1.000
    FB                1.000                               1.000    1.000
    FC                1.000                               1.000    1.000
    FD                1.000                               1.000    1.000
    FE                1.000                               1.000    1.000
    FF                1.000                               1.000    1.000</code></pre>
</div>
</div>
<section id="模型结果的报告" class="level4">
<h4 class="anchored" data-anchor-id="模型结果的报告">模型结果的报告</h4>
<p><a href="#cfareport"><code>summary</code></a>报告第一部分为模型基本信息，估计方法为最大似然估计，优化方法为非线性最小优化，待估参数51个，样本量313。</p>
<p><a href="#cfareport"><code>summary</code></a>报告第二部分为拟合指标，包括卡方值和检验结果、CFI、RMSEA、SRMR等。</p>
<ul>
<li>模型拟合度分析：对照前面的标准，卡方值显著性水平<span class="math inline">\(0&lt;0.05\)</span>，表示假设模型与观察值之间有显著的差异；<span class="math inline">\(\chi^2/df&gt;2\)</span>也说明拟合度不理想；NFI、NNFI、CFI均大于标准0.9，SRMR小于标准0.08，这四个指标都表明拟合比较理想；RMSEA为0.057略微大于标准0.05，表明模型拟合不理想；综合来看，理论模型没有达到最佳的拟合度，仍有修正的空间。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(cfa_fit, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>, <span class="st">"nfi"</span>,<span class="st">"nnfi"</span>,<span class="st">"cfi"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  chisq      df  pvalue     nfi    nnfi     cfi   rmsea    srmr 
241.755 120.000   0.000   0.915   0.942   0.955   0.057   0.052 </code></pre>
</div>
</div>
<p><a href="#cfareport"><code>summary</code></a>报告第三部分为参数估计结果，包括因子载荷、潜变量协方差、测量误差和潜变量的方差。</p>
<ul>
<li>潜变量（Latent variables）部分为因子载荷参数估计值相关结果，<code>std.lv</code>对应的是潜变量被标准化时的载荷，<code>std.all</code>对应的是所有变量都被标准化时的载荷（类似于标准化的回归系数）。<br>
</li>
<li>协方差（Covariances）部分为潜变量协方差，由于潜变量方差设定为1，此处协方差也等于潜变量间的相关系数。<br>
</li>
<li>方差（Variances）部分为测量误差的方差和潜变量的方差，由于潜变量方差设定为1，所以此处均为1。</li>
</ul>
</section>
<section id="残差分析" class="level4">
<h4 class="anchored" data-anchor-id="残差分析">残差分析</h4>
<p>模型拟合后可以依据拟合协方差矩阵列出估计的测量变量的方差和协方差，这些模型导出数与实际观察值之间的差距即为残差。通过分析标准化残差的大小和分布，可以了解测量变量间关系的拟合程度，确定存在问题的题项。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(cfa_fit) <span class="co"># 提取拟合协方差矩阵</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$cov
      A1    A2    A3    B1    B2    B3    C1    C2    C3    D1    D2    D3
A1 0.965                                                                  
A2 0.576 1.043                                                            
A3 0.500 0.433 0.937                                                      
B1 0.349 0.302 0.262 1.338                                                
B2 0.425 0.368 0.320 0.759 1.332                                          
B3 0.378 0.328 0.285 0.675 0.823 1.179                                    
C1 0.282 0.244 0.212 0.385 0.469 0.417 0.950                              
C2 0.297 0.257 0.223 0.405 0.494 0.439 0.515 1.061                        
C3 0.280 0.243 0.211 0.383 0.467 0.415 0.487 0.512 1.102                  
D1 0.275 0.239 0.207 0.286 0.348 0.310 0.296 0.312 0.295 0.873            
D2 0.252 0.218 0.190 0.262 0.319 0.284 0.271 0.285 0.269 0.601 0.700      
D3 0.223 0.193 0.168 0.231 0.282 0.251 0.239 0.252 0.238 0.531 0.486 0.829
E1 0.345 0.299 0.260 0.365 0.445 0.396 0.340 0.358 0.338 0.363 0.332 0.294
E2 0.391 0.339 0.294 0.413 0.504 0.448 0.385 0.405 0.383 0.411 0.376 0.333
E3 0.339 0.294 0.255 0.359 0.437 0.389 0.334 0.352 0.332 0.357 0.326 0.289
F1 0.363 0.315 0.274 0.198 0.241 0.214 0.269 0.283 0.268 0.164 0.150 0.133
F2 0.469 0.407 0.353 0.255 0.311 0.277 0.347 0.366 0.346 0.212 0.194 0.171
F3 0.446 0.386 0.335 0.243 0.296 0.263 0.330 0.347 0.328 0.201 0.184 0.163
      E1    E2    E3    F1    F2    F3
A1                                    
A2                                    
A3                                    
B1                                    
B2                                    
B3                                    
C1                                    
C2                                    
C3                                    
D1                                    
D2                                    
D3                                    
E1 0.942                              
E2 0.735 1.013                        
E3 0.638 0.721 0.951                  
F1 0.229 0.259 0.225 1.359            
F2 0.296 0.335 0.291 0.531 1.193      
F3 0.281 0.318 0.276 0.504 0.651 0.883</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>cfares <span class="ot">&lt;-</span> <span class="fu">resid</span>(cfa_fit)  <span class="co"># 提取残差</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cfares<span class="sc">$</span>cov</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       A1     A2     A3     B1     B2     B3     C1     C2     C3     D1     D2
A1  0.000                                                                      
A2 -0.003  0.000                                                               
A3  0.022 -0.037  0.000                                                        
B1 -0.080  0.057  0.037  0.000                                                 
B2 -0.009  0.104 -0.057  0.001  0.000                                          
B3 -0.021  0.053 -0.011  0.002 -0.001  0.000                                   
C1 -0.085  0.022 -0.054  0.022  0.015  0.024  0.000                            
C2 -0.019  0.039 -0.101  0.005 -0.020 -0.041  0.042  0.000                     
C3  0.070  0.167  0.079 -0.004  0.002  0.006 -0.050 -0.004  0.000              
D1  0.030  0.113 -0.048 -0.012  0.026  0.043 -0.052 -0.006  0.022  0.000       
D2 -0.033  0.021 -0.071 -0.031 -0.041 -0.029 -0.076 -0.003  0.018  0.008  0.000
D3 -0.010  0.075 -0.050 -0.005  0.057  0.067  0.094  0.114  0.117 -0.028  0.004
E1 -0.017  0.015  0.087  0.021  0.073  0.063 -0.001 -0.077  0.047  0.055  0.013
E2 -0.047  0.100  0.032 -0.029 -0.034 -0.024  0.024 -0.034  0.016 -0.021 -0.054
E3 -0.103  0.105 -0.010 -0.031 -0.013  0.019  0.005 -0.004  0.045  0.005 -0.019
F1 -0.018 -0.060  0.058 -0.035  0.097  0.021  0.070  0.118  0.111  0.107  0.130
F2 -0.007 -0.043 -0.064 -0.122 -0.060  0.004 -0.080 -0.048  0.121 -0.015 -0.005
F3  0.031 -0.007  0.018 -0.027  0.040  0.015 -0.006 -0.057  0.024 -0.033 -0.044
       D3     E1     E2     E3     F1     F2     F3
A1                                                 
A2                                                 
A3                                                 
B1                                                 
B2                                                 
B3                                                 
C1                                                 
C2                                                 
C3                                                 
D1                                                 
D2                                                 
D3  0.000                                          
E1  0.083  0.000                                   
E2  0.074 -0.001  0.000                            
E3  0.045 -0.016  0.010  0.000                     
F1  0.187  0.076  0.109  0.097  0.000              
F2  0.038 -0.056 -0.012 -0.019  0.019  0.000       
F3  0.028 -0.017  0.001 -0.016 -0.032  0.009  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(cfares<span class="sc">$</span>cov); <span class="fu">median</span>(cfares<span class="sc">$</span>cov)  <span class="co"># 残差的全距和中位数</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1216818  0.1866437</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.123659e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(cfa_fit, <span class="at">type=</span><span class="st">"standardized"</span>) <span class="co"># 提取标准化残差，方便与标准正态分布比较</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "standardized"

$cov
       A1     A2     A3     B1     B2     B3     C1     C2     C3     D1     D2
A1  0.000                                                                      
A2 -0.363  0.000                                                               
A3  1.765 -1.670  0.000                                                        
B1 -2.017  1.218  0.774  0.000                                                 
B2 -0.326  2.626 -1.426  0.055  0.000                                          
B3 -0.700  1.340 -0.288  0.081 -0.146  0.000                                   
C1 -2.886  0.559 -1.395  0.552  0.522  0.784  0.000                            
C2 -0.611  0.950 -2.455  0.117 -0.662 -1.305  2.421  0.000                     
C3  1.876  3.832  1.833 -0.099  0.044  0.162 -2.676 -0.185  0.000              
D1  1.262  3.253 -1.394 -0.301  0.901  1.417 -1.900 -0.216  0.653  0.000       
D2 -1.688  0.684 -2.317 -0.888 -1.700 -1.090 -3.170 -0.104  0.599  3.454  0.000
D3 -0.301  1.933 -1.283 -0.112  1.480  1.767  2.707  3.162  3.024 -4.148  0.748
E1 -0.643  0.417  2.439  0.528  2.335  1.975 -0.045 -2.494  1.359  2.226  0.609
E2 -2.361  3.078  0.956 -0.781 -1.407 -0.873  0.943 -1.297  0.479 -1.071 -3.481
E3 -3.617  2.895 -0.260 -0.760 -0.408  0.568  0.172 -0.119  1.255  0.213 -0.859
F1 -0.456 -1.244  1.205 -0.544  1.656  0.373  1.449  2.317  2.177  2.172  2.947
F2 -0.295 -1.216 -1.743 -2.351 -1.483  0.104 -2.284 -1.330  2.968 -0.463 -0.189
F3  1.823 -0.259  0.661 -0.666  1.394  0.490 -0.222 -2.153  0.745 -1.412 -2.229
       D3     E1     E2     E3     F1     F2     F3
A1                                                 
A2                                                 
A3                                                 
B1                                                 
B2                                                 
B3                                                 
C1                                                 
C2                                                 
C3                                                 
D1                                                 
D2                                                 
D3  0.000                                          
E1  2.629  0.000                                   
E2  2.415 -0.342  0.000                            
E3  1.378 -1.831  2.050  0.000                     
F1  3.664  1.520  2.231  1.915  0.000              
F2  0.933 -1.571 -0.403 -0.528  0.649  0.000       
F3  0.835 -0.641  0.056 -0.579 -2.117  1.473  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>cfastd <span class="ot">&lt;-</span> cfares<span class="sc">$</span>cov[<span class="fu">lower.tri</span>(<span class="fu">unclass</span>(cfares<span class="sc">$</span>cov),<span class="at">diag =</span> F)]</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">sample=</span>cfastd)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>() <span class="co"># 绘制QQ残差散点图分析是否服从正态分布</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/cfadev-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>模型修饰指数：残差分析除了初步观察测量变量间的问题，还可以将模型没有设定的关系参数加入假设，并与原设定模型相比，计算模型如果调整后这些残差变化对于模型改善的贡献，即为模型修饰指数（Modification Index）。</li>
<li>当MI指数大于5时，表示该残差有修正的必要。EPC（expected parameter change）表示预期的参数改变量，一般综合考虑MI和EPC确定修正的方向。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(cfa_fit, <span class="at">sort. =</span> T, <span class="at">maximum.number =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op rhs     mi    epc sepc.lv sepc.all sepc.nox
96   FC =~  D3 19.838  0.241   0.241    0.265    0.265
63   FA =~  C3 14.826  0.289   0.289    0.276    0.276
118  FE =~  A1 14.048 -0.258  -0.258   -0.262   -0.262
265  D1 ~~  D2 13.890  0.192   0.192    1.061    1.061
266  D1 ~~  D3 13.426 -0.132  -0.132   -0.448   -0.448
175  A2 ~~  E1 12.247 -0.097  -0.097   -0.243   -0.243</code></pre>
</div>
</div>
</section>
<section id="内在拟合度检验" class="level4">
<h4 class="anchored" data-anchor-id="内在拟合度检验">内在拟合度检验</h4>
<p>根据<a href="#internaltest">内部拟合检验部分</a>提出的各项内部拟合指标，对测量模型进行检验。</p>
<ul>
<li>项目质量检验：因子载荷均大于0.55，大部分大于0.71，可以通过。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>cfa_lambda <span class="ot">&lt;-</span> <span class="fu">inspect</span>(cfa_fit,<span class="at">what=</span><span class="st">"std"</span>)<span class="sc">$</span>lambda</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>cfa_lambda <span class="ot">&lt;-</span> cfa_lambda[cfa_lambda<span class="sc">!=</span><span class="dv">0</span>]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cfa_lambda, <span class="at">digits =</span> <span class="dv">2</span>)  <span class="co"># 检验因子载荷</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.83 0.69 0.63 0.68 0.83 0.79 0.72 0.71 0.66 0.87 0.89 0.72 0.83 0.91 0.81
[16] 0.55 0.76 0.84</code></pre>
</div>
</div>
<ul>
<li>组合信度CR均大于0.7，显示内在拟合较好；平均变异萃取量AVE除因素C、F外均大于0.5，说明拟合一般。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)    </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">compRelSEM</span>(cfa_fit) <span class="co"># 计算组合信度CR</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   FA    FB    FC    FD    FE    FF 
0.769 0.812 0.743 0.869 0.889 0.748 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AVE</span>(cfa_fit)        <span class="co"># 计算平均变异萃取量AVE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   FA    FB    FC    FD    FE    FF 
0.523 0.592 0.487 0.681 0.725 0.499 </code></pre>
</div>
</div>
<ul>
<li>因素区辩力：采取相关系数区间估计检验，潜变量的相关系数最大值为0.7，标准误约为0.05，95%置信区间为0.6-0.8，没有包含1，说明潜变量的区分度较好（参见<code>summary</code>报告第三部分的潜变量协方差，即相关系数）。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>cfa_res <span class="ot">&lt;-</span> <span class="fu">summary</span>(cfa_fit, <span class="at">standard=</span>T)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>cfa_res<span class="sc">$</span>pe[<span class="dv">43</span><span class="sc">:</span><span class="dv">57</span>,] <span class="sc">|&gt;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(lhs, op, rhs, est, se, z, std.all, pvalue) <span class="sc">|&gt;</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   lhs op rhs   est    se      z std.all pvalue
43  FA ~~  FB 0.542 0.054  9.989   0.542      0
44  FA ~~  FC 0.494 0.061  8.102   0.494      0
45  FA ~~  FD 0.417 0.058  7.176   0.417      0
46  FA ~~  FE 0.526 0.052 10.080   0.526      0
47  FA ~~  FF 0.695 0.046 15.148   0.695      0
48  FB ~~  FC 0.697 0.047 14.906   0.697      0
49  FB ~~  FD 0.447 0.055  8.127   0.447      0
50  FB ~~  FE 0.575 0.048 12.091   0.575      0
51  FB ~~  FF 0.391 0.061  6.403   0.391      0
52  FC ~~  FD 0.522 0.055  9.493   0.522      0
53  FC ~~  FE 0.603 0.050 12.127   0.603      0
54  FC ~~  FF 0.600 0.054 11.032   0.600      0
55  FD ~~  FE 0.557 0.046 12.046   0.557      0
56  FD ~~  FF 0.316 0.062  5.137   0.316      0
57  FE ~~  FF 0.443 0.056  7.944   0.443      0</code></pre>
</div>
</div>
</section>
</section>
<section id="测量模型的调整" class="level3">
<h3 class="anchored" data-anchor-id="测量模型的调整">测量模型的调整</h3>
<section id="测量模型调整的原则" class="level4">
<h4 class="anchored" data-anchor-id="测量模型调整的原则">测量模型调整的原则</h4>
<ul>
<li>对于测量模型，可以对测量变量与潜变量之间的关系进行调整，删减测量变量或建立测量变量与其他潜变量之间的联系，也可以对测量变量残差的共变关系进行调整增减。</li>
<li>对测量模型进行修正，应结合理论，避免过度拟合。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="cfa6.png" class="img-fluid figure-img" width="323"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="假设模型的调整和设定" class="level4">
<h4 class="anchored" data-anchor-id="假设模型的调整和设定">假设模型的调整和设定</h4>
<p>根据前面CFA分析检验的结果，MI指数显示测量变量C3与潜变量A之间的关系如果纳入模型能够提升拟合度14.82，增加参数量因子载荷0.28，综合考量是贡献最大的参数改善。因此需要调整假设和设定，测量变量C3同时受到潜变量C和A的影响，其他参数设定不变。</p>
</section>
<section id="模型调整后的结果报告" class="level4">
<h4 class="anchored" data-anchor-id="模型调整后的结果报告">模型调整后的结果报告</h4>
<ul>
<li>估计参数数量增加1个到52个，C3在A上的因子载荷为0.268，并且结果是显著的，并且其他变量显著性未受影响。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>new_model <span class="ot">&lt;-</span><span class="st">' </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="st">#define the measurement model  </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="st">  FA =~ L11*A1 + L21*A2 + L31*A3 + L37 * C3</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="st">  FB =~ L12*B1 + L22*B2 + L32*B3</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="st">  FC =~ L13*C1 + L23*C2 + L33*C3</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="st">  FD =~ L14*D1 + L24*D2 + L34*D3</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="st">  FE =~ L15*E1 + L25*E2 + L35*E3</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="st">  FF =~ L16*F1 + L26*F2 + L36*F3'</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>new_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(new_model,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> dat,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(new_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 30 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        52

  Number of observations                           313

Model Test User Model:
                                                      
  Test statistic                               226.794
  Degrees of freedom                               119
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  FA =~                                               
    A1       (L11)    0.805    0.051   15.803    0.000
    A2       (L21)    0.711    0.055   12.859    0.000
    A3       (L31)    0.616    0.054   11.510    0.000
    C3       (L37)    0.268    0.065    4.128    0.000
  FB =~                                               
    B1       (L12)    0.789    0.062   12.766    0.000
    B2       (L22)    0.961    0.058   16.591    0.000
    B3       (L32)    0.855    0.056   15.407    0.000
  FC =~                                               
    C1       (L13)    0.729    0.054   13.605    0.000
    C2       (L23)    0.755    0.057   13.284    0.000
    C3       (L33)    0.533    0.066    8.080    0.000
  FD =~                                               
    D1       (L14)    0.811    0.045   18.185    0.000
    D2       (L24)    0.741    0.040   18.743    0.000
    D3       (L34)    0.655    0.047   14.078    0.000
  FE =~                                               
    E1       (L15)    0.806    0.046   17.389    0.000
    E2       (L25)    0.912    0.046   19.857    0.000
    E3       (L35)    0.791    0.047   16.809    0.000
  FF =~                                               
    F1       (L16)    0.641    0.066    9.656    0.000
    F2       (L26)    0.828    0.058   14.305    0.000
    F3       (L36)    0.786    0.049   16.137    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  FA ~~                                               
    FB                0.545    0.054   10.046    0.000
    FC                0.409    0.067    6.078    0.000
    FD                0.424    0.058    7.319    0.000
    FE                0.533    0.052   10.283    0.000
    FF                0.700    0.046   15.368    0.000
  FB ~~                                               
    FC                0.668    0.049   13.556    0.000
    FD                0.447    0.055    8.128    0.000
    FE                0.574    0.048   12.089    0.000
    FF                0.391    0.061    6.401    0.000
  FC ~~                                               
    FD                0.491    0.057    8.614    0.000
    FE                0.569    0.052   10.857    0.000
    FF                0.545    0.059    9.309    0.000
  FD ~~                                               
    FE                0.557    0.046   12.045    0.000
    FF                0.316    0.062    5.137    0.000
  FE ~~                                               
    FF                0.443    0.056    7.943    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .A1                0.317    0.045    6.981    0.000
   .A2                0.538    0.054    9.962    0.000
   .A3                0.557    0.052   10.694    0.000
   .C3                0.629    0.057   10.951    0.000
   .B1                0.715    0.068   10.524    0.000
   .B2                0.408    0.057    7.221    0.000
   .B3                0.447    0.052    8.608    0.000
   .C1                0.418    0.051    8.222    0.000
   .C2                0.491    0.057    8.612    0.000
   .D1                0.216    0.031    7.036    0.000
   .D2                0.151    0.024    6.209    0.000
   .D3                0.400    0.037   10.802    0.000
   .E1                0.293    0.032    9.249    0.000
   .E2                0.181    0.030    6.108    0.000
   .E3                0.325    0.033    9.736    0.000
   .F1                0.949    0.083   11.402    0.000
   .F2                0.506    0.058    8.689    0.000
   .F3                0.265    0.042    6.283    0.000
    FA                1.000                           
    FB                1.000                           
    FC                1.000                           
    FD                1.000                           
    FE                1.000                           
    FF                1.000                           </code></pre>
</div>
</div>
<ul>
<li>模型拟合度的变化：卡方值依然显著未改善；卡方均值改善小于2；NFI、NNFI、CFI均有所增加；RMSEA、SRMR均有所减小，说明拟合度有改善。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(cfa_fit, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>, <span class="st">"nfi"</span>,<span class="st">"nnfi"</span>,<span class="st">"cfi"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="co"># 原设定模型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  chisq      df  pvalue     nfi    nnfi     cfi   rmsea    srmr 
241.755 120.000   0.000   0.915   0.942   0.955   0.057   0.052 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(new_fit, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>, <span class="st">"nfi"</span>,<span class="st">"nnfi"</span>,<span class="st">"cfi"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="co"># 调整后模型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  chisq      df  pvalue     nfi    nnfi     cfi   rmsea    srmr 
226.794 119.000   0.000   0.920   0.948   0.960   0.054   0.048 </code></pre>
</div>
</div>
<ul>
<li>参数估计的比较：调整的测量变量C3与因素A的因子载荷为0.27，与MI指数增加因子载荷0.28非常接近，模型调整后，因子C的载荷有所变化，在C1、C2、C3上的载荷由0.70、0.74、0.70变化为0.73、0.76、0.53；因子A上的载荷变化不大。模型调整后，潜变量的相关系数有所变化，变化最大的是因子A和因子C之间的相关系数。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/cfamodcom-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="模型的路径图" class="level3">
<h3 class="anchored" data-anchor-id="模型的路径图">模型的路径图</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(cfa_fit, <span class="at">what =</span> <span class="st">"std"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/cfaplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(new_fit, <span class="at">what =</span> <span class="st">"std"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/cfaplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="路径分析" class="level2">
<h2 class="anchored" data-anchor-id="路径分析">路径分析</h2>
<p>路径分析所包括的变量都是外显观察变量，不涉及潜变量，所用的操作可采用结构方程分析技术，相当于没有测量模型的结构方程。当模型结构过于复杂时，会出现自由度<span class="math inline">\(df\le0\)</span>的情况，无法计算拟合指数。</p>
<section id="模型设定与识别" class="level3">
<h3 class="anchored" data-anchor-id="模型设定与识别">模型设定与识别</h3>
<p>研究假设组织气氛知觉包括6个变量：组织价值（VALUE）、工作方式（JOBSTYLE）、团队合作（TEAMWORK）、领导风格（LEADERSH）、学习成长（LEARNING）、环境气氛（ENVIRON）。这6个变量均会影响员工的组织承诺感（commit），进而影响员工的工作绩效（out），此时，组织承诺作为中介变量，同时年资（TENURE）是控制变量，既影响组织承诺，也影响工作绩效。 整个模型有9个观察变量，因此测量数据<span class="math inline">\(DP=(9\times10)/2=45\)</span>。模型设定6个组织气氛知觉变量之间都相关，因此有15个相关系数参数，7个外生变量有7个方差参数，2个内生变量有2个解释残差（即回归方程的误差项），9个路径回归系数，所以待估参数<span class="math inline">\(t=15+7+2+9=33\)</span>个。<span class="math inline">\(t&lt;DP\)</span>因此模型时可识别的。</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="path1.png" class="img-fluid figure-img" width="318"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="参数估计" class="level3">
<h3 class="anchored" data-anchor-id="参数估计">参数估计</h3>
<section id="变量描述" class="level4">
<h4 class="anchored" data-anchor-id="变量描述">变量描述</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_sav</span>(<span class="st">"ch07.sav"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">datasummary_skim</span>(dat, <span class="at">fun_numeric =</span> <span class="fu">list</span>(<span class="st">'取值'</span><span class="ot">=</span>NUnique, <span class="st">'缺失值'</span><span class="ot">=</span>PercentMissing, <span class="st">'均值'</span><span class="ot">=</span>Mean, <span class="st">'中位数'</span><span class="ot">=</span>Median,<span class="st">'标准差'</span><span class="ot">=</span>SD, <span class="st">'最小值'</span><span class="ot">=</span>Min, <span class="st">'最大值'</span><span class="ot">=</span>Max), <span class="at">output =</span> <span class="st">"data.frame"</span>, <span class="at">type =</span> <span class="st">"numeric"</span>, <span class="fu">fmt_sprintf</span>(<span class="st">"%.2f"</span>)) <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">取值</th>
<th style="text-align: left;">缺失值</th>
<th style="text-align: left;">均值</th>
<th style="text-align: left;">中位数</th>
<th style="text-align: left;">标准差</th>
<th style="text-align: left;">最小值</th>
<th style="text-align: left;">最大值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">out</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.22</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">0.63</td>
<td style="text-align: left;">2.00</td>
<td style="text-align: left;">5.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">commit</td>
<td style="text-align: left;">22</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">9.49</td>
<td style="text-align: left;">9.67</td>
<td style="text-align: left;">1.59</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">12.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VALUE</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.27</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">0.81</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">JOBSTYLE</td>
<td style="text-align: left;">15</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.18</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">0.95</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TEAMWORK</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">0.83</td>
<td style="text-align: left;">1.33</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">LEADERSH</td>
<td style="text-align: left;">12</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.87</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.77</td>
<td style="text-align: left;">2.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LEARNING</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.71</td>
<td style="text-align: left;">5.00</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: left;">1.67</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">ENVIRONM</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">4.43</td>
<td style="text-align: left;">4.33</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: left;">1.00</td>
<td style="text-align: left;">6.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TENURE</td>
<td style="text-align: left;">106</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">9.12</td>
<td style="text-align: left;">4.00</td>
<td style="text-align: left;">9.23</td>
<td style="text-align: left;">0.08</td>
<td style="text-align: left;">32.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="参数估计设定" class="level4">
<h4 class="anchored" data-anchor-id="参数估计设定">参数估计设定</h4>
<ul>
<li>设定结构模型部分（代码part1），组织承诺commit被7个变量解释；员工绩效被2个变量解释。代码形式与回归方程类似。</li>
<li>设定相关系数部分（代码part2），lavaan包会自动外生变量添加两两相关的相关系数参数，路径图里显示6个组织气氛变量与年资不相关，因此要手动设定。</li>
<li>还可以定义感兴趣的间接效应和总效应（代码part3和part4）。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>path1 <span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="st">#part1：设定结构模型</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="st">  commit~ a1*VALUE+a2*JOBSTYLE+a3*TEAMWORK+a4*LEADERSH</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="st">          +a5*LEARNING+a6*ENVIRONM+a7*TENURE</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="st">  out~c*TENURE+b*commit</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="st">#part2：设定外生变量的相关系数</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ JOBSTYLE </span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ TEAMWORK </span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ LEADERSH </span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ LEARNING</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ ENVIRONM </span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ TEAMWORK </span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ LEADERSH </span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ LEARNING </span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ ENVIRONM </span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ LEADERSH </span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ LEARNING </span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ ENVIRONM</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="st">  LEADERSH ~~ LEARNING </span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="st">  LEADERSH ~~ ENVIRONM </span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="st">  LEARNING ~~ ENVIRONM </span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a><span class="st">  # 设定相关系数为0</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*VALUE </span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*JOBSTYLE </span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*TEAMWORK </span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*LEADERSH </span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*LEARNING</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*ENVIRONM</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a><span class="st">#part3：定义间接效应 (a*b)</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="st">  a1b := a1*b</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="st">  a2b := a2*b</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="st">  a3b := a3*b</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a><span class="st">  a4b := a4*b</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="st">  a5b := a5*b</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a><span class="st">  a6b := a6*b</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a><span class="st">  a7b := a7*b</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="st">#part4：定义年资TENURE的总效应</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + a7b'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="结果报告" class="level4">
<h4 class="anchored" data-anchor-id="结果报告">结果报告</h4>
<p><code>summary</code>报告第一部分为模型基本信息，估计方法为最大似然估计，优化方法为非线性最小优化，待估参数33个，样本量281.</p>
<p><code>summary</code>报告第二部分为拟合度检验，包括卡方值和检验结果、CFI、RMSEA、SRMR等。</p>
<ul>
<li>模型拟合度分析：对照前面的标准，CFI值0.98大于标准0.9，SRMR值0.06小于标准0.08，表明拟合比较理想；RMSEA为0.067略微大于标准0.05，表明模型拟合不理想；综合来看，理论模型拟合度较好。</li>
</ul>
<p><code>summary</code>报告第三部分为参数估计结果，包括路径回归系数、外生变量协方差、外生变量方差和内生变量的解释残差、直接效应和间接效应参数估计。</p>
<ul>
<li>回归模型（Regressions）部分为路径回归系数估计值相关结果，std.all对应的是标准化的回归系数。团队合作（TEAMWORK）和领导风格（LEADERSH）对组织承诺（commit）的回归系数不显著。其余回归系数均显著。<br>
</li>
<li>协方差（Covariances）部分为外生变量协方差，由于模型设定年资（TENURE）与其他外生变量不相关，因此固定为0，std.all是标准化后的协方差，即外生变量的相关系数。协方差估计结果均显著，说明外生变量间相关性存在。<br>
</li>
<li>方差（Variances）部分为内生变量的解释残差（.commit和.out）和外生变量的方差。<br>
</li>
<li>定义参数估计（Defined Parameters）部分为总效应和间接效应系数相关信息。同样，团队合作（TEAMWORK）和领导风格（LEADERSH）的间接效应系数a3b和a4b不显著，显然这与回归模型的结论一致。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>path1_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(path1, <span class="at">data =</span> dat)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>path1_res <span class="ot">&lt;-</span> <span class="fu">summary</span>(path1_fit, <span class="at">fit.measures=</span>T,<span class="at">standard =</span> T)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>path1_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 43 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        33

  Number of observations                           281

Model Test User Model:
                                                      
  Test statistic                                27.106
  Degrees of freedom                                12
  P-value (Chi-square)                           0.007

Model Test Baseline Model:

  Test statistic                               866.406
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.982
  Tucker-Lewis Index (TLI)                       0.945

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3522.025
  Loglikelihood unrestricted model (H1)      -3508.473
                                                      
  Akaike (AIC)                                7110.051
  Bayesian (BIC)                              7230.116
  Sample-size adjusted Bayesian (SABIC)       7125.475

Root Mean Square Error of Approximation:

  RMSEA                                          0.067
  90 Percent confidence interval - lower         0.033
  90 Percent confidence interval - upper         0.101
  P-value H_0: RMSEA &lt;= 0.050                    0.181
  P-value H_0: RMSEA &gt;= 0.080                    0.287

Standardized Root Mean Square Residual:

  SRMR                                           0.060

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  commit ~                                                              
    VALUE     (a1)    0.428    0.116    3.687    0.000    0.428    0.218
    JOBSTYLE  (a2)    0.242    0.100    2.409    0.016    0.242    0.146
    TEAMWORK  (a3)    0.106    0.118    0.895    0.371    0.106    0.056
    LEADERSH  (a4)    0.108    0.119    0.912    0.362    0.108    0.053
    LEARNING  (a5)    0.363    0.115    3.159    0.002    0.363    0.203
    ENVIRONM  (a6)    0.276    0.106    2.611    0.009    0.276    0.153
    TENURE    (a7)    0.022    0.008    2.816    0.005    0.022    0.129
  out ~                                                                 
    TENURE     (c)    0.011    0.004    2.964    0.003    0.011    0.157
    commit     (b)    0.172    0.021    8.135    0.000    0.172    0.430

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  VALUE ~~                                                              
    JOBSTYLE          0.367    0.051    7.244    0.000    0.367    0.479
    TEAMWORK          0.271    0.043    6.288    0.000    0.271    0.405
    LEADERSH          0.206    0.039    5.274    0.000    0.206    0.331
    LEARNING          0.344    0.047    7.328    0.000    0.344    0.486
    ENVIRONM          0.369    0.047    7.782    0.000    0.369    0.524
  JOBSTYLE ~~                                                           
    TEAMWORK          0.420    0.053    7.853    0.000    0.420    0.530
    LEADERSH          0.328    0.048    6.829    0.000    0.328    0.446
    LEARNING          0.461    0.057    8.078    0.000    0.461    0.550
    ENVIRONM          0.269    0.052    5.149    0.000    0.269    0.323
  TEAMWORK ~~                                                           
    LEADERSH          0.318    0.043    7.443    0.000    0.318    0.496
    LEARNING          0.390    0.049    7.884    0.000    0.390    0.533
    ENVIRONM          0.368    0.049    7.571    0.000    0.368    0.506
  LEADERSH ~~                                                           
    LEARNING          0.386    0.047    8.259    0.000    0.386    0.566
    ENVIRONM          0.249    0.043    5.800    0.000    0.249    0.369
  LEARNING ~~                                                           
    ENVIRONM          0.332    0.050    6.626    0.000    0.332    0.430
  VALUE ~~                                                              
    TENURE            0.000                               0.000    0.000
  JOBSTYLE ~~                                                           
    TENURE            0.000                               0.000    0.000
  TEAMWORK ~~                                                           
    TENURE            0.000                               0.000    0.000
  LEADERSH ~~                                                           
    TENURE            0.000                               0.000    0.000
  LEARNING ~~                                                           
    TENURE            0.000                               0.000    0.000
  ENVIRONM ~~                                                           
    TENURE            0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .commit            1.456    0.123   11.853    0.000    1.456    0.586
   .out               0.305    0.026   11.853    0.000    0.305    0.773
    VALUE             0.647    0.055   11.853    0.000    0.647    1.000
    JOBSTYLE          0.907    0.077   11.853    0.000    0.907    1.000
    TEAMWORK          0.691    0.058   11.853    0.000    0.691    1.000
    LEADERSH          0.598    0.050   11.853    0.000    0.598    1.000
    LEARNING          0.776    0.065   11.853    0.000    0.776    1.000
    ENVIRONM          0.765    0.065   11.853    0.000    0.765    1.000
    TENURE           84.834    7.157   11.853    0.000   84.834    1.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    a1b               0.073    0.022    3.358    0.001    0.073    0.094
    a2b               0.041    0.018    2.310    0.021    0.041    0.063
    a3b               0.018    0.020    0.889    0.374    0.018    0.024
    a4b               0.019    0.021    0.906    0.365    0.019    0.023
    a5b               0.062    0.021    2.945    0.003    0.062    0.087
    a6b               0.047    0.019    2.486    0.013    0.047    0.066
    a7b               0.004    0.001    2.661    0.008    0.004    0.055
    total             0.014    0.004    3.787    0.000    0.014    0.212</code></pre>
</div>
</div>
</section>
</section>
<section id="直接与间接效应" class="level3">
<h3 class="anchored" data-anchor-id="直接与间接效应">直接与间接效应</h3>
<p>路径分析的目的之一是探讨内生变量被外生变量解释的总体效应、直接效应和间接效应。尽管采用分阶段回归的方式也能够估计出各个效应值，但是结构方程技术更方便对这些效应进行统计检验。</p>
<ul>
<li><p>直接效应：summary报告参数估计的回归模型部分的路径系数便是直接效应。例如组织价值（VALUE）对组织承诺（commit）的直接效应为a1，即0.428，而年资（TENURE）对工作绩效（out）的直接效应为c，即0.011.</p></li>
<li><p>间接效应：外生变量通过中介变量对另一个内生变量产生的影响，便是间接效应。例如间接效应系数a1b代表组织价值对组织承诺的效应（a1=0.428）通过组织承诺对工作绩效的直接效应（b=0.172）间接影响到工作绩效，形成间接效应（a1b），并且数值上间接效应等于两段直接效应的乘积，即<span class="math inline">\(a1b=a1\times b=0.428\times 0.172=0.073\)</span>，统计检验显示其p值为0.001，该间接效应具有统计上的意义。</p></li>
<li><p>总效应：一个变量对结果变量直接效应和间接效应的总和便是总效应。例如，年资（TENURE）对工作绩效的直接效应（c=0.011），年资通过组织承诺对工作绩效的间接效应（a7b=0.004），那么年资对工作绩效的总效应<span class="math inline">\(total=c+a7b=0.011+0.004\simeq 0.015\)</span>，统计检验其p值为0，该总效应具有统计上的意义。</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>path1_res<span class="sc">$</span>pe[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">40</span><span class="sc">:</span><span class="dv">47</span>),] <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lhs, op, rhs, est, se, z, std.all, pvalue) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      lhs op      rhs   est    se     z std.all pvalue
1  commit  ~    VALUE 0.428 0.116 3.687   0.218  0.000
2  commit  ~ JOBSTYLE 0.242 0.100 2.409   0.146  0.016
3  commit  ~ TEAMWORK 0.106 0.118 0.895   0.056  0.371
4  commit  ~ LEADERSH 0.108 0.119 0.912   0.053  0.362
5  commit  ~ LEARNING 0.363 0.115 3.159   0.203  0.002
6  commit  ~ ENVIRONM 0.276 0.106 2.611   0.153  0.009
7  commit  ~   TENURE 0.022 0.008 2.816   0.129  0.005
8     out  ~   TENURE 0.011 0.004 2.964   0.157  0.003
9     out  ~   commit 0.172 0.021 8.135   0.430  0.000
40    a1b :=     a1*b 0.073 0.022 3.358   0.094  0.001
41    a2b :=     a2*b 0.041 0.018 2.310   0.063  0.021
42    a3b :=     a3*b 0.018 0.020 0.889   0.024  0.374
43    a4b :=     a4*b 0.019 0.021 0.906   0.023  0.365
44    a5b :=     a5*b 0.062 0.021 2.945   0.087  0.003
45    a6b :=     a6*b 0.047 0.019 2.486   0.066  0.013
46    a7b :=     a7*b 0.004 0.001 2.661   0.055  0.008
47  total :=    c+a7b 0.014 0.004 3.787   0.212  0.000</code></pre>
</div>
</div>
</section>
<section id="模型调整" class="level3">
<h3 class="anchored" data-anchor-id="模型调整">模型调整</h3>
<p>模型调整主要依据MI指数，考察大于5的取值，结合理论进行判断。</p>
<ol type="1">
<li>工作绩效与组织承诺的残差间有显著的修正空间，MI值为15.2，但是预期变化量EPC为-0.24（原设定为0），表明有某种未观察到的变量，同时影响工作绩效和组织承诺，但是对它们的影响效应是相反的，尚缺乏有效的理论支撑。<br>
</li>
<li>工作绩效对组织承诺的结构参数对应的MI值为15.2，表示该参数要纳入模型，但是如果纳入会导致回馈循环效应，并且预期改变量为-0.8，表示员工工作绩效越高，组织承诺越低，难以有理论或逻辑上的解释，缺乏合理性。<br>
</li>
<li>学习成长、领导风格、组织价值、团队合作对工作绩效的结构参数对应的MI值均大于5，预测值也为正，表明这些变量得分越高，工作绩效越好，理论逻辑上是合理的。可以考虑增加这些变量对结果变量的直接效应。</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(path1_fit, <span class="at">sort. =</span> T, <span class="at">maximum.number =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op      rhs     mi    epc sepc.lv sepc.all sepc.nox
48  commit ~~      out 15.228 -0.244  -0.244   -0.366   -0.366
63  commit  ~      out 15.228 -0.800  -0.800   -0.319   -0.319
68     out  ~ LEARNING 13.063  0.158   0.158    0.222    0.222
67     out  ~ LEADERSH  9.170  0.140   0.140    0.173    0.173
64     out  ~    VALUE  7.031  0.127   0.127    0.162    0.162
66     out  ~ TEAMWORK  6.771  0.115   0.115    0.152    0.152
125 TENURE  ~ ENVIRONM  5.352  1.453   1.453    0.138    0.138
120 TENURE  ~    VALUE  4.581  1.462   1.462    0.128    0.128</code></pre>
</div>
</div>
<p>先增加一条学习成长到工作绩效的直接效应，设定新的模型，试试看。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>path2 <span class="ot">&lt;-</span> <span class="st">'#part1：set the structure model</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="st">  commit~ a1*VALUE+a2*JOBSTYLE+a3*TEAMWORK+a4*LEADERSH</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="st">          +a5*LEARNING+a6*ENVIRONM+a7*TENURE</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="st">  out~c*TENURE+b*commit + d*LEARNING # 添加直接效应d</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="st">#part2：set the correlation</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ JOBSTYLE </span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ TEAMWORK </span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ LEADERSH </span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ LEARNING</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="st">  VALUE    ~~ ENVIRONM </span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ TEAMWORK </span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ LEADERSH </span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ LEARNING </span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="st">  JOBSTYLE ~~ ENVIRONM </span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ LEADERSH </span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ LEARNING </span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="st">  TEAMWORK ~~ ENVIRONM</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="st">  LEADERSH ~~ LEARNING </span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="st">  LEADERSH ~~ ENVIRONM </span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="st">  LEARNING ~~ ENVIRONM </span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="st">  # fix</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*VALUE </span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*JOBSTYLE </span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*TEAMWORK </span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*LEADERSH </span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*LEARNING</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="st">  TENURE   ~~ 0*ENVIRONM</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="st">#part3：define indirect effect (a*b)</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="st">  a1b := a1*b</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="st">  a2b := a2*b</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="st">  a3b := a3*b</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="st">  a4b := a4*b</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="st">  a5b := a5*b</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a><span class="st">  a6b := a6*b</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="st">  a7b := a7*b</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="st">#part4：define total effect of COMMIT</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="st">  total := c + a7b'</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>path2_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(path2, <span class="at">data =</span> dat)</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(path2_fit, <span class="at">fit.measures=</span>T, <span class="at">standard=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 44 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        34

  Number of observations                           281

Model Test User Model:
                                                      
  Test statistic                                13.714
  Degrees of freedom                                11
  P-value (Chi-square)                           0.249

Model Test Baseline Model:

  Test statistic                               866.406
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.997
  Tucker-Lewis Index (TLI)                       0.989

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3515.330
  Loglikelihood unrestricted model (H1)      -3508.473
                                                      
  Akaike (AIC)                                7098.659
  Bayesian (BIC)                              7222.363
  Sample-size adjusted Bayesian (SABIC)       7114.551

Root Mean Square Error of Approximation:

  RMSEA                                          0.030
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.073
  P-value H_0: RMSEA &lt;= 0.050                    0.736
  P-value H_0: RMSEA &gt;= 0.080                    0.024

Standardized Root Mean Square Residual:

  SRMR                                           0.041

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  commit ~                                                              
    VALUE     (a1)    0.428    0.116    3.687    0.000    0.428    0.218
    JOBSTYLE  (a2)    0.242    0.100    2.409    0.016    0.242    0.146
    TEAMWORK  (a3)    0.106    0.118    0.895    0.371    0.106    0.056
    LEADERSH  (a4)    0.108    0.119    0.912    0.362    0.108    0.053
    LEARNING  (a5)    0.363    0.115    3.159    0.002    0.363    0.203
    ENVIRONM  (a6)    0.276    0.106    2.611    0.009    0.276    0.153
    TENURE    (a7)    0.022    0.008    2.816    0.005    0.022    0.129
  out ~                                                                 
    TENURE     (c)    0.011    0.004    3.192    0.001    0.011    0.166
    commit     (b)    0.125    0.024    5.201    0.000    0.125    0.315
    LEARNING   (d)    0.158    0.043    3.706    0.000    0.158    0.222

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  VALUE ~~                                                              
    JOBSTYLE          0.367    0.051    7.244    0.000    0.367    0.479
    TEAMWORK          0.271    0.043    6.288    0.000    0.271    0.405
    LEADERSH          0.206    0.039    5.274    0.000    0.206    0.331
    LEARNING          0.344    0.047    7.328    0.000    0.344    0.486
    ENVIRONM          0.369    0.047    7.782    0.000    0.369    0.524
  JOBSTYLE ~~                                                           
    TEAMWORK          0.420    0.053    7.853    0.000    0.420    0.530
    LEADERSH          0.328    0.048    6.829    0.000    0.328    0.446
    LEARNING          0.461    0.057    8.078    0.000    0.461    0.550
    ENVIRONM          0.269    0.052    5.149    0.000    0.269    0.323
  TEAMWORK ~~                                                           
    LEADERSH          0.318    0.043    7.443    0.000    0.318    0.496
    LEARNING          0.390    0.049    7.884    0.000    0.390    0.533
    ENVIRONM          0.368    0.049    7.571    0.000    0.368    0.506
  LEADERSH ~~                                                           
    LEARNING          0.386    0.047    8.259    0.000    0.386    0.566
    ENVIRONM          0.249    0.043    5.800    0.000    0.249    0.369
  LEARNING ~~                                                           
    ENVIRONM          0.332    0.050    6.626    0.000    0.332    0.430
  VALUE ~~                                                              
    TENURE            0.000                               0.000    0.000
  JOBSTYLE ~~                                                           
    TENURE            0.000                               0.000    0.000
  TEAMWORK ~~                                                           
    TENURE            0.000                               0.000    0.000
  LEADERSH ~~                                                           
    TENURE            0.000                               0.000    0.000
  LEARNING ~~                                                           
    TENURE            0.000                               0.000    0.000
  ENVIRONM ~~                                                           
    TENURE            0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .commit            1.456    0.123   11.853    0.000    1.456    0.586
   .out               0.291    0.025   11.853    0.000    0.291    0.739
    VALUE             0.647    0.055   11.853    0.000    0.647    1.000
    JOBSTYLE          0.907    0.077   11.853    0.000    0.907    1.000
    TEAMWORK          0.691    0.058   11.853    0.000    0.691    1.000
    LEADERSH          0.598    0.050   11.853    0.000    0.598    1.000
    LEARNING          0.776    0.065   11.853    0.000    0.776    1.000
    ENVIRONM          0.765    0.065   11.853    0.000    0.765    1.000
    TENURE           84.834    7.157   11.853    0.000   84.834    1.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    a1b               0.054    0.018    3.008    0.003    0.054    0.069
    a2b               0.030    0.014    2.186    0.029    0.030    0.046
    a3b               0.013    0.015    0.882    0.378    0.013    0.018
    a4b               0.014    0.015    0.898    0.369    0.014    0.017
    a5b               0.046    0.017    2.700    0.007    0.046    0.064
    a6b               0.035    0.015    2.333    0.020    0.035    0.048
    a7b               0.003    0.001    2.477    0.013    0.003    0.040
    total             0.014    0.004    3.869    0.000    0.014    0.206</code></pre>
</div>
</div>
<p>学习成长到工作绩效的直接效应（d）为0.158，p值为0，说明该效应存在。比较前后模型的拟合度指标发现，卡方值明显下降，p值已大于0.05，RMSEA和SRMR都小于目标值。新模型完美拟合，无需再进行调整。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(path1_fit, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>, <span class="st">"nfi"</span>,<span class="st">"nnfi"</span>,<span class="st">"cfi"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="co"># 原设定模型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
27.106 12.000  0.007  0.969  0.945  0.982  0.067  0.060 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(path2_fit, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"df"</span>, <span class="st">"pvalue"</span>, <span class="st">"nfi"</span>,<span class="st">"nnfi"</span>,<span class="st">"cfi"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>)) <span class="co"># 调整后模型</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
13.714 11.000  0.249  0.984  0.989  0.997  0.030  0.041 </code></pre>
</div>
</div>
<p>前后两个模型是嵌套关系，可以进行嵌套模型的卡方差异检验，检验模型修正带来的拟合优度增幅是否具有显著意义。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(path1_fit, path2_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

          Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
path2_fit 11 7098.7 7222.4 13.714                                          
path1_fit 12 7110.1 7230.1 27.106     13.391 0.20999       1  0.0002528 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>可以绘制两个模型的路径图进行比较。</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/pathplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/pathplot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="统合模型分析" class="level2">
<h2 class="anchored" data-anchor-id="统合模型分析">统合模型分析</h2>
<section id="统合模型的基础" class="level3">
<h3 class="anchored" data-anchor-id="统合模型的基础">统合模型的基础</h3>
<ul>
<li>统合模型的构成：统合模型包含测量模型和结构模型。如果结构模型中的变量都是潜变量，则称为完全统合模型或完全潜在模型，如果结构模型中的某一个或某几个变量是单一指标的测量变量，则称为部分潜在模型。</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem2.png" class="img-fluid figure-img" width="330"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem3.png" class="img-fluid figure-img" width="232"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>统合模型分析步骤：通常采用两阶段策略，第一个阶段是针对测量模型确定因素结构的拟合性，第二阶段则是在不改变测量模型的前提下，增加结构模型的设定，并评估结构模型的拟合性。该方法的优点在于测量模型的检测可以提供潜变量的聚敛与区分效度的信息，结构模型则可以提供预测效度的证据。</p></li>
<li><p>变量组合的策略：结构方程模型分析经常会以变量组合策略简化测量模型，使结构模型得以在比较简化的情形下进行估计。</p>
<ul>
<li>例如某个潜变量有6个测量变量，可以每两题加起来求平均值，将6个变量聚合成3个变量以降低模型的复杂程度。聚合层次的变量分数称为组合分数。特别是当样本量太少，而模型估计参数很多，变通做法是通过将测量变量组合成单一变量，将潜变量转换为观察变量后进行路径分析。<br>
</li>
<li>变量组合的优点：简化模型、提高模型拟合度、获得较理想的估计解、得到较好的测量信度、较高的变量解释力、观察变量的尺度更具有等距性与正态性、更理想的检验效力（每题的样本量与题数的比值更高）、避免特殊题项的干扰。<br>
</li>
<li>变量组合不应为简化而简化，需要提出简化的理由与统计量上支持，必须经过验证性因子分析的检验，保证构念的单一维度，并且组合的题项要具有相同的尺度（例如都是二分变量或者都是相同点数的likert量表）。</li>
</ul></li>
</ul>
</section>
<section id="统合模型分析的操作" class="level3">
<h3 class="anchored" data-anchor-id="统合模型分析的操作">统合模型分析的操作</h3>
<p>250位教师的创意教学行为调查数据，包括教师的创造人格特质（Person）、创意教学自我效能感（Efficacy）、组织社会化（Socialized）、教学创新行为（Crea）等4个潜变量的10个测量变量。</p>
<ul>
<li>创造人格特质包括多角推理、兴趣广泛、乐在工作3个测量变量<br>
</li>
<li>自我效能感包括自我肯定、自我防卫、社会支持寻求、外在压力抗衡4个测量变量<br>
</li>
<li>组织社会化包括组织融入和工作熟练度2个测量变量<br>
</li>
<li>教学创新行为已将9个量表题项加总成组合分数</li>
</ul>
<section id="假设模型" class="level4">
<h4 class="anchored" data-anchor-id="假设模型">假设模型</h4>
<p>研究假设：</p>
<ol type="1">
<li>教师创意教学⾃我效能越⾼，越能够表现出创意教学⾏为。<br>
</li>
<li>教师个⼈创造性格越强、组织社会化程度越⾼，则创意教学⾃我效能越⾼。<br>
</li>
<li>教师个⼈创造性格与组织社会化程度两项特质，会透过⾃我效能的中介作⽤，间接影响教师的创意教学⾏为。</li>
</ol>
<p>数据是以协方差矩阵的形式给出的。可以通过热力图展示测量变量间的相关系数。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modelsummary)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.95 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semptools) <span class="co"># 给路径图标记显著性</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">250</span> <span class="co"># 样本量</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 协方差矩阵</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>COV <span class="ot">&lt;-</span> <span class="fu">structure</span>(<span class="fu">c</span>(<span class="fl">17.711</span>, <span class="fl">1.843</span>, <span class="fl">0.801</span>, <span class="fl">1.243</span>, <span class="fl">1.692</span>, <span class="fl">7.518</span>, <span class="fl">7.585</span>, </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">6.499</span>, <span class="fl">3.02</span>, <span class="fl">2.663</span>, <span class="fl">1.843</span>, <span class="fl">0.404</span>, <span class="fl">0.146</span>, <span class="fl">0.227</span>, <span class="fl">0.226</span>, <span class="fl">1.074</span>, </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.062</span>, <span class="fl">0.906</span>, <span class="fl">0.369</span>, <span class="fl">0.318</span>, <span class="fl">0.801</span>, <span class="fl">0.146</span>, <span class="fl">0.374</span>, <span class="fl">0.11</span>, <span class="fl">0.115</span>, </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.301</span>, <span class="fl">0.538</span>, <span class="fl">0.388</span>, <span class="fl">0.237</span>, <span class="fl">0.307</span>, <span class="fl">1.243</span>, <span class="fl">0.227</span>, <span class="fl">0.11</span>, <span class="fl">0.589</span>, </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.208</span>, <span class="fl">0.531</span>, <span class="fl">0.609</span>, <span class="fl">0.434</span>, <span class="fl">0.322</span>, <span class="fl">0.335</span>, <span class="fl">1.692</span>, <span class="fl">0.226</span>, <span class="fl">0.115</span>, </span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.208</span>, <span class="fl">0.393</span>, <span class="fl">0.741</span>, <span class="fl">0.806</span>, <span class="fl">0.664</span>, <span class="fl">0.196</span>, <span class="fl">0.326</span>, <span class="fl">7.518</span>, <span class="fl">1.074</span>, </span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.301</span>, <span class="fl">0.531</span>, <span class="fl">0.741</span>, <span class="fl">7.565</span>, <span class="fl">5.202</span>, <span class="fl">4.53</span>, <span class="fl">1.947</span>, <span class="fl">2.092</span>, <span class="fl">7.585</span>, </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.062</span>, <span class="fl">0.538</span>, <span class="fl">0.609</span>, <span class="fl">0.806</span>, <span class="fl">5.202</span>, <span class="fl">7.046</span>, <span class="fl">4.626</span>, <span class="fl">1.524</span>, <span class="fl">1.824</span>, </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">6.499</span>, <span class="fl">0.906</span>, <span class="fl">0.388</span>, <span class="fl">0.434</span>, <span class="fl">0.664</span>, <span class="fl">4.53</span>, <span class="fl">4.626</span>, <span class="fl">6.335</span>, <span class="fl">1.649</span>, </span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.662</span>, <span class="fl">3.02</span>, <span class="fl">0.369</span>, <span class="fl">0.237</span>, <span class="fl">0.322</span>, <span class="fl">0.196</span>, <span class="fl">1.947</span>, <span class="fl">1.524</span>, <span class="fl">1.649</span>, </span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">4.482</span>, <span class="fl">2.335</span>, <span class="fl">2.663</span>, <span class="fl">0.318</span>, <span class="fl">0.307</span>, <span class="fl">0.335</span>, <span class="fl">0.326</span>, <span class="fl">2.092</span>, <span class="fl">1.824</span>, </span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">1.662</span>, <span class="fl">2.335</span>, <span class="fl">2.982</span>), <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">10</span>L, <span class="dv">10</span>L), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">"CREAT"</span>, </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>                                                                              <span class="st">"SEFF1"</span>, <span class="st">"SEFF2"</span>, <span class="st">"SEFF3"</span>, <span class="st">"SEFF4"</span>, <span class="st">"PER1"</span>, <span class="st">"PER2"</span>, <span class="st">"PER3"</span>, <span class="st">"SOC1"</span>, </span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>                                                                              <span class="st">"SOC2"</span>), <span class="fu">c</span>(<span class="st">"CREAT"</span>, <span class="st">"SEFF1"</span>, <span class="st">"SEFF2"</span>, <span class="st">"SEFF3"</span>, <span class="st">"SEFF4"</span>, <span class="st">"PER1"</span>, </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>                                                                                         <span class="st">"PER2"</span>, <span class="st">"PER3"</span>, <span class="st">"SOC1"</span>, <span class="st">"SOC2"</span>)))</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="co"># X和Y相关系数，等于二者的协方差除以二者标准差的积：</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>COR <span class="ot">&lt;-</span> COV <span class="sc">/</span> (<span class="fu">sqrt</span>(<span class="fu">diag</span>(COV) <span class="sc">%*%</span> <span class="fu">t</span>(<span class="fu">diag</span>(COV))))</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 调用corrplot命令，绘制热力图</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a lighter palette</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>col <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"#BB4444"</span>, <span class="st">"#EE9988"</span>, <span class="st">"#FFFFFF"</span>, <span class="st">"#77AADD"</span>, <span class="st">"#4477AA"</span>))</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(COR, <span class="at">method =</span> <span class="st">"shade"</span>, <span class="at">shade.col =</span> <span class="cn">NA</span>, <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span>,</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">col</span>(<span class="dv">200</span>), <span class="at">addCoef.col =</span> <span class="st">"black"</span>, <span class="at">cl.pos =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/semdata-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem4.png" class="img-fluid figure-img" width="260"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="模型设定与识别-1" class="level4">
<h4 class="anchored" data-anchor-id="模型设定与识别-1">模型设定与识别</h4>
<ul>
<li>由于该模型有10个测量变量，测量数据的数目为<span class="math inline">\(DP=10\times11/2=55\)</span>个。<br>
</li>
<li>模型有5个外生测量变量，5个内生测量变量，所以有5个外生测量残差，4个内生测量残差（潜变量CREA只有1个指标，完美预测，该测量变量残差固定为0，因后面要调整测量模型，概念模型中依然采取测量变量和潜变量分开的方式，本质是1个变量），待估参数9个。<br>
</li>
<li>模型有2个外生潜变量，2个内生潜变量，所以外生潜变量的协方差1个（概念图未标出）和方差2个（与之前的CFA部分处理不同，此处不通过限定外生变量方差为1来标准化，改为限定第一个因子载荷为1，如下），内生潜变量2个解释残差，待估参数5个。<br>
</li>
<li>每个测量变量仅受一个潜变量影响，故产生10个因子载荷，为确立两个潜变量的尺度，潜变量的第一因子载荷固定为1，所以要扣除4个，待估参数6个。<br>
</li>
<li>内生潜变量被外生潜变量解释，有5个待估结构参数（路径系数）。<br>
</li>
<li>因此，待估参数<span class="math inline">\(t=9+5+6+5=25\)</span>个。</li>
</ul>
</section>
<section id="测量模型分析阶段" class="level4">
<h4 class="anchored" data-anchor-id="测量模型分析阶段">测量模型分析阶段</h4>
<p>模型拟合情况大致良好，卡方p值为0，卡方自由度比为2.6，接近2，NFI为0.94，CFI为0.96，RMSEA为0.08，SRMR为0.04，可以继续检验MI指数按照验证性因子分析介绍的方式调整测量模型，这里直接进行第二阶段的结构模型估计。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>cfa_mod <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="st"># measurement model</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA =~ 1*CREAT # 由于CREA只有一个测量变量，因此设定因子载荷为1，默认测量变量残差方差为0</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF =~ SEFF1 + SEFF2 + SEFF3 + SEFF4</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="st">    PER  =~ PER1  + PER2  + PER3</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  =~ SOC1  + SOC2'</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>cfa_fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> cfa_mod, <span class="at">sample.cov =</span> COV, <span class="at">sample.nobs =</span> <span class="dv">250</span>)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cfa_fit, <span class="at">standard=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 63 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        25

  Number of observations                           250

Model Test User Model:
                                                      
  Test statistic                                80.964
  Degrees of freedom                                30
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  CREA =~                                                               
    CREAT             1.000                               4.200    1.000
  SEFF =~                                                               
    SEFF1             1.000                               0.537    0.846
    SEFF2             0.474    0.074    6.421    0.000    0.255    0.417
    SEFF3             0.735    0.091    8.116    0.000    0.395    0.515
    SEFF4             0.834    0.070   11.981    0.000    0.448    0.716
  PER =~                                                                
    PER1              1.000                               2.274    0.828
    PER2              1.009    0.064   15.877    0.000    2.294    0.866
    PER3              0.875    0.062   14.129    0.000    1.989    0.792
  SOC =~                                                                
    SOC1              1.000                               1.478    0.700
    SOC2              1.064    0.149    7.148    0.000    1.573    0.913

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  CREA ~~                                                               
    SEFF              1.861    0.205    9.093    0.000    0.826    0.826
    PER               7.467    0.852    8.761    0.000    0.782    0.782
    SOC               2.575    0.546    4.717    0.000    0.415    0.415
  SEFF ~~                                                               
    PER               0.985    0.121    8.145    0.000    0.807    0.807
    SOC               0.342    0.076    4.485    0.000    0.432    0.432
  PER ~~                                                                
    SOC               1.787    0.350    5.114    0.000    0.532    0.532

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .CREAT             0.000                               0.000    0.000
   .SEFF1             0.114    0.018    6.519    0.000    0.114    0.284
   .SEFF2             0.308    0.028   10.834    0.000    0.308    0.826
   .SEFF3             0.431    0.041   10.582    0.000    0.431    0.734
   .SEFF4             0.191    0.020    9.385    0.000    0.191    0.488
   .PER1              2.365    0.283    8.355    0.000    2.365    0.314
   .PER2              1.758    0.241    7.302    0.000    1.758    0.250
   .PER3              2.354    0.261    9.033    0.000    2.354    0.373
   .SOC1              2.279    0.339    6.714    0.000    2.279    0.511
   .SOC2              0.495    0.311    1.592    0.111    0.495    0.167
    CREA             17.640    1.578   11.180    0.000    1.000    1.000
    SEFF              0.288    0.037    7.721    0.000    1.000    1.000
    PER               5.170    0.667    7.751    0.000    1.000    1.000
    SOC               2.185    0.438    4.992    0.000    1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(cfa_fit)[<span class="fu">c</span>(<span class="st">'chisq'</span>, <span class="st">'df'</span>, <span class="st">'pvalue'</span>, <span class="st">'nfi'</span>, <span class="st">'nnfi'</span>, <span class="st">'cfi'</span>, <span class="st">'rmsea'</span>, <span class="st">'srmr'</span>)] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
80.964 30.000  0.000  0.936  0.937  0.958  0.082  0.042 </code></pre>
</div>
</div>
</section>
<section id="结构模型分析阶段" class="level4">
<h4 class="anchored" data-anchor-id="结构模型分析阶段">结构模型分析阶段</h4>
<p>将测量模型与结构模型组合在一起就构成了统合模型。测量模型不变，按照研究假设设定结构模型，进行分析并报告结果。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sem_mod<span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="st"># 测量模型</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA =~ 1*CREAT</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF =~ SEFF1 + SEFF2 + SEFF3 + SEFF4</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="st">    PER  =~ PER1  + PER2  + PER3</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  =~ SOC1  + SOC2</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="st"># 结构模型</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF ~ a1*PER + c1*SOC</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA ~ a2*PER + b1*SEFF + c2*SOC</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="st"># 设定外生潜变量之间的协方差</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  ~~ PER </span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>sem_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> sem_mod, <span class="at">sample.cov =</span> COV, <span class="at">sample.nobs =</span> <span class="dv">250</span>)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sem_fit, <span class="at">standard=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 81 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        25

  Number of observations                           250

Model Test User Model:
                                                      
  Test statistic                                80.964
  Degrees of freedom                                30
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  CREA =~                                                               
    CREAT             1.000                               4.200    1.000
  SEFF =~                                                               
    SEFF1             1.000                               0.537    0.846
    SEFF2             0.474    0.074    6.421    0.000    0.255    0.417
    SEFF3             0.735    0.091    8.116    0.000    0.395    0.515
    SEFF4             0.834    0.070   11.981    0.000    0.448    0.716
  PER =~                                                                
    PER1              1.000                               2.274    0.828
    PER2              1.009    0.064   15.877    0.000    2.294    0.866
    PER3              0.875    0.062   14.129    0.000    1.989    0.792
  SOC =~                                                                
    SOC1              1.000                               1.478    0.700
    SOC2              1.064    0.149    7.148    0.000    1.573    0.913

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SEFF ~                                                                
    PER       (a1)    0.190    0.019    9.944    0.000    0.805    0.805
    SOC       (c1)    0.001    0.026    0.046    0.964    0.003    0.003
  CREA ~                                                                
    PER       (a2)    0.616    0.189    3.266    0.001    0.334    0.334
    SEFF      (b1)    4.364    0.807    5.407    0.000    0.558    0.558
    SOC       (c2)   -0.010    0.147   -0.065    0.948   -0.003   -0.003

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  PER ~~                                                                
    SOC               1.787    0.350    5.114    0.000    0.532    0.532

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .CREAT             0.000                               0.000    0.000
   .SEFF1             0.114    0.018    6.519    0.000    0.114    0.284
   .SEFF2             0.308    0.028   10.834    0.000    0.308    0.826
   .SEFF3             0.431    0.041   10.582    0.000    0.431    0.734
   .SEFF4             0.191    0.020    9.385    0.000    0.191    0.488
   .PER1              2.365    0.283    8.355    0.000    2.365    0.314
   .PER2              1.758    0.241    7.302    0.000    1.758    0.250
   .PER3              2.354    0.261    9.033    0.000    2.354    0.373
   .SOC1              2.279    0.339    6.714    0.000    2.279    0.511
   .SOC2              0.495    0.311    1.592    0.111    0.495    0.167
   .CREA              4.941    0.600    8.238    0.000    0.280    0.280
   .SEFF              0.100    0.020    4.954    0.000    0.349    0.349
    PER               5.170    0.667    7.751    0.000    1.000    1.000
    SOC               2.185    0.438    4.992    0.000    1.000    1.000</code></pre>
</div>
</div>
<p>各因子载荷均达到显著性水平，说明测量模型理想；结构模型部分，性格对自我效能感、自我效能感对创新行性格对创新行为的3个回归系数显著，社会化对自我效能感和创新行为的2个回归系数均不显著。两个外生潜变量性格和社会化的协方差和2个方差都是显著的。<br>
模型拟合情况如下，可以看到，模型的拟合程度还是不错的，但仍有修正空间。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(sem_fit)[<span class="fu">c</span>(<span class="st">'chisq'</span>, <span class="st">'df'</span>, <span class="st">'pvalue'</span>, <span class="st">'nfi'</span>, <span class="st">'nnfi'</span>, <span class="st">'cfi'</span>, <span class="st">'rmsea'</span>, <span class="st">'srmr'</span>)] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>) <span class="co"># 查看拟合结果</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
80.964 30.000  0.000  0.936  0.937  0.958  0.082  0.042 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(sem_fit, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">what =</span> <span class="st">"std"</span>, </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fade =</span> F, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">rotation =</span> <span class="dv">2</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge.color =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">esize =</span> <span class="dv">3</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge.label.cex =</span> <span class="fl">1.1</span>,</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/semfit-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="模型调整-1" class="level4">
<h4 class="anchored" data-anchor-id="模型调整-1">模型调整</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(sem_fit, <span class="at">sort. =</span> T, <span class="at">maximum.number =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs op   rhs     mi    epc sepc.lv sepc.all sepc.nox
47   PER =~ SEFF1 13.127  0.154   0.351    0.553    0.553
64 CREAT ~~ SEFF4 13.032  0.329   0.329       NA       NA
34  CREA =~ SEFF4 12.759  0.073   0.308    0.492    0.492
72 SEFF1 ~~ SEFF4 11.869 -0.068  -0.068   -0.459   -0.459
80 SEFF2 ~~  PER1  9.985 -0.196  -0.196   -0.230   -0.230</code></pre>
</div>
</div>
<p>模型修饰指数(MI)最高的五项推荐了5条修改路径。第一条是外生潜变量性格（PER）影响自我效能的内生测量变量自我肯定（SEFF1）的因子载荷（MI=13.13）；第二条是内生测量变量创新行为（CREAT）和压力抗衡（SEFF4）的测量残差的相关性；第三条是内生潜变量创新行为（CREA）影响自我效能的测量变量压力抗衡（SEFF4）的因子载荷（MI=13.03）；第四条是测量变量自我肯定（SEFF1）和压力抗衡（SEFF4）的测量误差的相关性；第五条是测量变量（SEFF2）与（PER1）之间的测量残差的相关性。首先模型修正以结构参数和测量因子载荷参数优先，因为这些参数涉及模型的潜变量的测量和研究假设，残差的考虑与观察不到的因素和隐含条件相关，因此不优先考虑对其调整。因此重点关注第一条和第三条建议路径。同时潜变量与测量变量之间的关系，也优先考虑内生潜变量对内生测量变量的影响或外生潜变量对外生测量变量的影响，在测量模型层面考虑内外生变量的交叉影响会使得模型过于复杂，也很难有理论的支撑。因此，选择第三条路径进行修正，这条路径也有比较合理的解释，即创新行为（CREA）影响压力抗衡（SEFF4）的因子载荷，意味当教师表现出创新行为后，可能增强其抗压的信念，因此可以将此参数纳入模型设定中。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>mod1_mod <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="st"># 测量模型</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA =~ CREAT + SEFF4 # 修饰模型，添加CREA影响SEFF4的路径</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF =~ SEFF1 + SEFF2 + SEFF3 + SEFF4</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="st">    PER  =~ PER1  + PER2  + PER3</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  =~ SOC1  + SOC2</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="st">    CREAT ~~ 0 * CREAT  # 固定内生测量变量CREAT的残差为0</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="st"># 结构模型</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF ~ a1*PER + c1*SOC</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA ~ a2*PER + b1*SEFF + c2*SOC</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="st"># 设定外源潜在变量间的协方差</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  ~~ PER </span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a>mod1_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> mod1_mod, <span class="at">sample.cov =</span> COV, <span class="at">sample.nobs =</span> <span class="dv">250</span>)</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1_fit, <span class="at">standard=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 94 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        26

  Number of observations                           250

Model Test User Model:
                                                      
  Test statistic                                67.863
  Degrees of freedom                                29
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  CREA =~                                                               
    CREAT             1.000                               4.200    1.000
    SEFF4             0.058    0.013    4.614    0.000    0.243    0.389
  SEFF =~                                                               
    SEFF1             1.000                               0.584    0.921
    SEFF2             0.432    0.069    6.290    0.000    0.253    0.414
    SEFF3             0.665    0.086    7.773    0.000    0.389    0.507
    SEFF4             0.361    0.101    3.589    0.000    0.211    0.337
  PER =~                                                                
    PER1              1.000                               2.280    0.831
    PER2              1.003    0.063   15.965    0.000    2.288    0.864
    PER3              0.872    0.061   14.206    0.000    1.988    0.791
  SOC =~                                                                
    SOC1              1.000                               1.484    0.702
    SOC2              1.056    0.147    7.173    0.000    1.567    0.909

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SEFF ~                                                                
    PER       (a1)    0.205    0.020   10.479    0.000    0.801    0.801
    SOC       (c1)   -0.017    0.027   -0.618    0.537   -0.043   -0.043
  CREA ~                                                                
    PER       (a2)    0.916    0.190    4.827    0.000    0.497    0.497
    SEFF      (b1)    2.561    0.713    3.590    0.000    0.356    0.356
    SOC       (c2)    0.039    0.154    0.255    0.798    0.014    0.014

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  PER ~~                                                                
    SOC               1.807    0.351    5.145    0.000    0.534    0.534

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .CREAT             0.000                               0.000    0.000
   .SEFF4             0.211    0.020   10.758    0.000    0.211    0.539
   .SEFF1             0.061    0.025    2.483    0.013    0.061    0.151
   .SEFF2             0.309    0.028   10.864    0.000    0.309    0.829
   .SEFF3             0.436    0.041   10.613    0.000    0.436    0.743
   .PER1              2.334    0.279    8.355    0.000    2.334    0.310
   .PER2              1.783    0.240    7.443    0.000    1.783    0.254
   .PER3              2.357    0.260    9.079    0.000    2.357    0.374
   .SOC1              2.261    0.340    6.657    0.000    2.261    0.507
   .SOC2              0.515    0.308    1.672    0.094    0.515    0.173
   .CREA              5.970    0.640    9.330    0.000    0.338    0.338
   .SEFF              0.134    0.029    4.631    0.000    0.393    0.393
    PER               5.200    0.667    7.795    0.000    1.000    1.000
    SOC               2.203    0.439    5.014    0.000    1.000    1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(mod1_fit)[<span class="fu">c</span>(<span class="st">'chisq'</span>, <span class="st">'df'</span>, <span class="st">'pvalue'</span>, <span class="st">'nfi'</span>, <span class="st">'nnfi'</span>, <span class="st">'cfi'</span>, <span class="st">'rmsea'</span>, <span class="st">'srmr'</span>)] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>) <span class="co"># 查看拟合结果</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
67.863 29.000  0.000  0.946  0.950  0.968  0.073  0.041 </code></pre>
</div>
</div>
<p>新添加的标准化因子载荷为0.389，达到显著水平。整体模型拟合度也有改善，卡方值为67.86，RMSEA为0.073。再检查MI指数，新的路径建议第四项SEFF3与SEFF4的残差相关还需要添加。其余建议路径都是内生测量变量与外生测量变量残差之间的相关性，建议路径太复杂不考虑。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(mod1_fit, <span class="at">sort. =</span> T, <span class="at">maximum.number =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs op   rhs     mi    epc sepc.lv sepc.all sepc.nox
84 SEFF1 ~~  SOC2 10.929 -0.128  -0.128   -0.723   -0.723
86 SEFF2 ~~  PER1 10.650 -0.201  -0.201   -0.237   -0.237
76 SEFF4 ~~  SOC1  9.449 -0.146  -0.146   -0.212   -0.212
72 SEFF4 ~~ SEFF3  8.778  0.060   0.060    0.199    0.199
90 SEFF2 ~~  SOC2  8.058  0.127   0.127    0.319    0.319</code></pre>
</div>
</div>
<p>添加残差相关路径后，设定模型进行分析。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>mod2_mod <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="st"># 测量模型</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA =~ CREAT + SEFF4 # 修饰模型，添加CREA影响SEFF4的路径</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF =~ SEFF1 + SEFF2 + SEFF3 + SEFF4</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="st">    PER  =~ PER1  + PER2  + PER3</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  =~ SOC1  + SOC2</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="st">    CREAT ~~ 0 * CREAT </span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="st"># 结构模型</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF ~ a1*PER + c1*SOC</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="st">    CREA ~ a2*PER + b1*SEFF + c2*SOC</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="st"># 设定外源潜在变量间的协方差</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="st">    SOC  ~~ PER </span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="st">    SEFF3 ~~ SEFF4 # 添加内生测量变量的相关性</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="st"># 定义间接效应 (a*b)</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="st">    PERindiCREA := a1*b1</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="st">    SOCindiCREA := c1*b1</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="st"># 定义总效应</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="st">    PERtotCREA := PERindiCREA + a2</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="st">    SOCtotCREA := SOCindiCREA + c2</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>mod2_fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(<span class="at">model =</span> mod2_mod, <span class="at">sample.cov =</span> COV, <span class="at">sample.nobs =</span> <span class="dv">250</span>)</span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(mod2_fit)[<span class="fu">c</span>(<span class="st">'chisq'</span>, <span class="st">'df'</span>, <span class="st">'pvalue'</span>, <span class="st">'nfi'</span>, <span class="st">'nnfi'</span>, <span class="st">'cfi'</span>, <span class="st">'rmsea'</span>, <span class="st">'srmr'</span>)] <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">3</span>) <span class="co"># 查看拟合结果</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df pvalue    nfi   nnfi    cfi  rmsea   srmr 
59.089 28.000  0.001  0.953  0.959  0.974  0.067  0.039 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(mod2_fit, <span class="at">sort. =</span> T, <span class="at">maximum.number =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     lhs op   rhs     mi    epc sepc.lv sepc.all sepc.nox
90 SEFF2 ~~  PER1 10.595 -0.201  -0.201   -0.236   -0.236
80 SEFF4 ~~  SOC1  9.903 -0.147  -0.147   -0.211   -0.211
88 SEFF1 ~~  SOC2  9.604 -0.123  -0.123   -0.807   -0.807
60   SOC =~ SEFF1  9.189 -0.129  -0.191   -0.301   -0.301
94 SEFF2 ~~  SOC2  8.452  0.130   0.130    0.327    0.327</code></pre>
</div>
</div>
<p>模型拟合优度有所提升，卡方值减少到59.09，RMSEA下降到0.067。MI指数检验，只剩内生与外生测量变量的相关性路径，不考虑复杂关系，没有需要调整的路径。同时，由于最终模型和原模型有嵌套关系，因此可以进行卡方检验，显示模型具有显著改进，因此模型调整结束。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(mod2_fit, sem_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

         Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
mod2_fit 28 7919.1 8014.2 59.089                                          
sem_fit  30 7937.0 8025.0 80.964     21.875 0.19937       2  1.778e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="报告分析结果" class="level4">
<h4 class="anchored" data-anchor-id="报告分析结果">报告分析结果</h4>
<ul>
<li>报告标准化系数：包括标准化的因子载荷、结构模型的标准化系数等。</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2_fit, <span class="at">standard=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 235 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        27

  Number of observations                           250

Model Test User Model:
                                                      
  Test statistic                                59.089
  Degrees of freedom                                28
  P-value (Chi-square)                           0.001

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  CREA =~                                                               
    CREAT             1.000                               4.200    1.000
    SEFF4             0.062    0.011    5.502    0.000    0.262    0.420
  SEFF =~                                                               
    SEFF1             1.000                               0.597    0.942
    SEFF2             0.414    0.068    6.122    0.000    0.247    0.405
    SEFF3             0.631    0.085    7.403    0.000    0.377    0.492
    SEFF4             0.311    0.090    3.470    0.001    0.186    0.297
  PER =~                                                                
    PER1              1.000                               2.283    0.832
    PER2              1.001    0.063   15.987    0.000    2.286    0.863
    PER3              0.871    0.061   14.233    0.000    1.988    0.791
  SOC =~                                                                
    SOC1              1.000                               1.482    0.701
    SOC2              1.059    0.148    7.166    0.000    1.569    0.911

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  SEFF ~                                                                
    PER       (a1)    0.209    0.020   10.678    0.000    0.799    0.799
    SOC       (c1)   -0.023    0.027   -0.847    0.397   -0.057   -0.057
  CREA ~                                                                
    PER       (a2)    0.960    0.186    5.148    0.000    0.522    0.522
    SEFF      (b1)    2.301    0.672    3.423    0.001    0.327    0.327
    SOC       (c2)    0.047    0.155    0.306    0.759    0.017    0.017

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  PER ~~                                                                
    SOC               1.805    0.351    5.139    0.000    0.534    0.534
 .SEFF4 ~~                                                              
   .SEFF3             0.060    0.021    2.864    0.004    0.060    0.193

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .CREAT             0.000                               0.000    0.000
   .SEFF4             0.215    0.020   10.911    0.000    0.215    0.552
   .SEFF1             0.046    0.027    1.676    0.094    0.046    0.113
   .SEFF2             0.311    0.029   10.905    0.000    0.311    0.836
   .SEFF3             0.445    0.042   10.669    0.000    0.445    0.758
   .PER1              2.323    0.278    8.348    0.000    2.323    0.308
   .PER2              1.794    0.240    7.490    0.000    1.794    0.256
   .PER3              2.357    0.259    9.089    0.000    2.357    0.374
   .SOC1              2.268    0.340    6.679    0.000    2.268    0.508
   .SOC2              0.508    0.309    1.644    0.100    0.508    0.171
   .CREA              6.082    0.642    9.477    0.000    0.345    0.345
   .SEFF              0.145    0.032    4.555    0.000    0.407    0.407
    PER               5.212    0.667    7.811    0.000    1.000    1.000
    SOC               2.196    0.439    5.007    0.000    1.000    1.000

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    PERindiCREA       0.481    0.142    3.396    0.001    0.262    0.262
    SOCindiCREA      -0.053    0.064   -0.835    0.404   -0.019   -0.019
    PERtotCREA        1.441    0.123   11.681    0.000    0.783    0.783
    SOCtotCREA       -0.006    0.168   -0.034    0.973   -0.002   -0.002</code></pre>
</div>
</div>
<ul>
<li>报告直接效应和间接效应</li>
</ul>
<p>展示创造性格（PER）和组织社会化（SOC），对于创意教学行为（CREA）的间接效应和总效应量及其统计检验。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2_fit, <span class="at">standard =</span> T)<span class="sc">$</span>pe <span class="sc">|&gt;</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(op <span class="sc">==</span> <span class="st">":="</span>) <span class="sc">|&gt;</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(label, est, se, z, pvalue, std.all) <span class="sc">|&gt;</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(., <span class="dv">3</span>))) <span class="sc">|&gt;</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(label) <span class="sc">|&gt;</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"潜在变量路径分析的部分复杂效应量"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>潜在变量路径分析的部分复杂效应量</caption>
<thead>
<tr class="header">
<th style="text-align: left;">label</th>
<th style="text-align: right;">est</th>
<th style="text-align: right;">se</th>
<th style="text-align: right;">z</th>
<th style="text-align: right;">pvalue</th>
<th style="text-align: right;">std.all</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PERindiCREA</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">3.396</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.262</td>
</tr>
<tr class="even">
<td style="text-align: left;">PERtotCREA</td>
<td style="text-align: right;">1.441</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">11.681</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.783</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SOCindiCREA</td>
<td style="text-align: right;">-0.053</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">-0.835</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">-0.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">SOCtotCREA</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">0.168</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">0.973</td>
<td style="text-align: right;">-0.002</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>报告路径图</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(mod2_fit, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">what =</span> <span class="st">"std"</span>, </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">fade =</span> F, <span class="co"># 关闭路径颜色渐变</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">rotation =</span> <span class="dv">2</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">layout =</span> <span class="st">"tree2"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge.color =</span> <span class="st">"darkgrey"</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">esize =</span> <span class="dv">3</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">edge.label.cex =</span> <span class="fl">1.1</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">ask =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sem_files/figure-html/semmodpath-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>参考文献：《结构方程与建模的原理与应用》，邱皓政、林碧芳著，中国轻工业出版社，2009.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>